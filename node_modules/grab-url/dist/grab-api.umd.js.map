{
    "version": 3,
    "file": "grab-api.umd.js",
    "sources": [
        "../src/log.ts",
        "../src/grab-api.ts"
    ],
    "sourcesContent": [
        "/**\n * ### Colorized Log With JSON Structure\n * ![Debug log](https://i.imgur.com/R8Qp6Vg.png)\n * Logs messages to the console with custom styling,\n * prints JSON with description of structure layout,\n * and showing debug output in development only.\n * @param {string|object} message - The message to log. If an object is provided, it will be stringified.\n * @param {string|string[]} [options.style] default='color: blue; font-size: 11pt;' - CSS style string\n * @param {boolean} [options.hideInProduction] -  default = auto-detects based on hostname.\n *  If true, uses `console.debug` (hidden in production). If false, uses `console.log`.\n *\n */\nexport function log(message: string|object  = \"\", options: LogOptions = {}) {\n  let {\n    color = null,\n    style = \"color: #66ccff; font-size: 10pt;\",\n    hideInProduction = undefined,\n    startSpinner = false,\n    stopSpinner = false,\n  } = options;\n  const colors = getColors();\n\n  // Auto-detect if we should hide logs in production based on hostname\n  if (typeof hideInProduction === \"undefined\")\n    hideInProduction =\n      typeof window !== \"undefined\" &&\n      window?.location.hostname.includes(\"localhost\");\n\n  // For objects, print both the structure visualization and full JSON\n  if (typeof message === \"object\")\n    message =\n      printJSONStructure(message) + \"\\n\\n\" + JSON.stringify(message, null, 2);\n\n  //colorize in terminal (%c is only in browser)\n  if (color && typeof process !== undefined)\n    message = (colors[color] || \"\") + message + colors.reset;\n\n  //  Displays an animated spinner in the terminal with the provided text.\n  var i = 0;\n\n  if (startSpinner)\n    (global || globalThis).interval = setInterval(() => {\n      process.stdout.write(\n        (colors[color] || \"\") +\n          \"\\r\" +\n          \"‚†ã‚†ô‚†π‚†∏‚†º‚†¥‚†¶‚†ß‚†á‚†è\".split(\"\")[(i = ++i % 10)] +\n          \" \" +\n          message +\n          colors.reset\n      );\n    }, 50);\n  else if (stopSpinner) {\n    clearInterval((global || globalThis).interval);\n    process.stdout.write(\n      \"\\r\" + (message || \"‚úî Done\") + \" \".repeat(message.length + 20) + \"\\n\"\n    );\n  } else if (typeof style === \"string\") {\n    // check if style is a one word color code or named color\n    //test if style is valid as a CSS color name\n    if (style.split(\" \").length == 1 || color) {\n      style = `color: ${color || style}; font-size: 11pt;`;\n    } else {\n      // check if style is valid as a CSS color code\n      if (style.match(/^#[0-9a-fA-F]{6}$/)) {\n        style = `color: ${style}; font-size: 11pt;`;\n      }\n    }\n    // Use console.debug for production-hidden logs, console.log otherwise\n    if (hideInProduction)\n      console.debug((style ? \"%c\" : \"\") + (message || \"\"), style);\n    else console.log((style ? \"%c\" : \"\") + (message || \"\"), style);\n  } else if (typeof style === \"object\") console.log(message, ...(style as any));\n  return true;\n}\n\nexport interface LogOptions {\n  /** CSS style string or array of CSS strings for browser console styling */\n  style?: string | string[];\n  /** Optional color name or code for terminal environments */\n  color?: string | null;\n  /** If true, hides log in production (auto-detects by hostname if undefined) */\n  hideInProduction?: boolean;\n  /** Start a spinner (for CLI tools, optional) */\n  startSpinner?: boolean;\n  /** Stop a spinner (for CLI tools, optional) */\n  stopSpinner?: boolean;\n}\n\n\n/**\n * Available color formats\n */\nexport enum ColorFormat {\n  ANSI = 'ansi',\n  HTML = 'html',\n  AUTO = 'auto'\n}\n\n/**\n * Available color names\n */\nexport enum ColorName {\n  RESET = 'reset',\n  BLACK = 'black',\n  RED = 'red',\n  GREEN = 'green',\n  YELLOW = 'yellow',\n  BLUE = 'blue',\n  MAGENTA = 'magenta',\n  CYAN = 'cyan',\n  WHITE = 'white',\n  GRAY = 'gray',\n  BRIGHT_RED = 'brightRed',\n  BRIGHT_GREEN = 'brightGreen',\n  BRIGHT_YELLOW = 'brightYellow',\n  BRIGHT_BLUE = 'brightBlue',\n  BRIGHT_MAGENTA = 'brightMagenta',\n  BRIGHT_CYAN = 'brightCyan',\n  BRIGHT_WHITE = 'brightWhite',\n  BG_RED = 'bgRed',\n  BG_GREEN = 'bgGreen',\n  BG_YELLOW = 'bgYellow',\n  BG_BLUE = 'bgBlue',\n  BG_MAGENTA = 'bgMagenta',\n  BG_CYAN = 'bgCyan',\n  BG_WHITE = 'bgWhite',\n  BG_GRAY = 'bgGray'\n}\n\n/**\n * Color mapping with ANSI codes and HTML hex values\n * @type {Record<ColorName, [number, string]>}\n * @description Maps color names to [ansiCode, hexValue] pairs\n * - ansiCode: ANSI escape sequence number for terminal colors\n * - hexValue: Hex color value (without #) for HTML/CSS\n */\nconst colorMap: Record<ColorName, [number, string]> = {\n  [ColorName.RESET]: [0, ''],\n  [ColorName.BLACK]: [30, '000000'],\n  [ColorName.RED]: [31, 'ff0000'],\n  [ColorName.GREEN]: [32, '00ff00'],\n  [ColorName.YELLOW]: [33, 'ffff00'],\n  [ColorName.BLUE]: [34, '0000ff'],\n  [ColorName.MAGENTA]: [35, 'ff00ff'],\n  [ColorName.CYAN]: [36, '00ffff'],\n  [ColorName.WHITE]: [37, 'ffffff'],\n  [ColorName.GRAY]: [90, '808080'],\n  [ColorName.BRIGHT_RED]: [91, 'ff5555'],\n  [ColorName.BRIGHT_GREEN]: [92, '55ff55'],\n  [ColorName.BRIGHT_YELLOW]: [93, 'ffff55'],\n  [ColorName.BRIGHT_BLUE]: [94, '5555ff'],\n  [ColorName.BRIGHT_MAGENTA]: [95, 'ff55ff'],\n  [ColorName.BRIGHT_CYAN]: [96, '55ffff'],\n  [ColorName.BRIGHT_WHITE]: [97, 'ffffff'],\n  [ColorName.BG_RED]: [41, 'ff0000'],\n  [ColorName.BG_GREEN]: [42, '00ff00'],\n  [ColorName.BG_YELLOW]: [43, 'ffff00'],\n  [ColorName.BG_BLUE]: [44, '0000ff'],\n  [ColorName.BG_MAGENTA]: [45, 'ff00ff'],\n  [ColorName.BG_CYAN]: [46, '00ffff'],\n  [ColorName.BG_WHITE]: [47, 'ffffff'],\n  [ColorName.BG_GRAY]: [100, '808080']\n};\n\n/**\n * Returns color codes based on the specified format\n * @param format - Output format for colors\n *   - 'ansi': Returns ANSI escape codes (e.g., '\\x1b[31m')\n *   - 'html': Returns HTML hex colors (e.g., '#ff0000')\n *   - 'auto': Auto-detects environment (HTML for browser, ANSI for Node.js)\n * @returns Object with color names as keys and color codes as values\n */\nexport function getColors(format: ColorFormat = typeof window !== 'undefined' ? ColorFormat.HTML : ColorFormat.ANSI): Record<ColorName, string> {\n  const colors: Record<ColorName, string> = {} as Record<ColorName, string>;\n  for (const [name, [ansiCode, hexCode]] of Object.entries(colorMap)) {\n    const colorName = name as ColorName;\n    colors[colorName] = format === ColorFormat.HTML ? '#' + hexCode : '\\x1b[' + ansiCode + 'm';\n  }\n  return colors;\n}\n\n/**\n * Determines the appropriate color code for a given value type\n * Used for consistent color coding in the structure visualization\n */\nfunction getColorForType(value) {\n  const colors = getColors();\n  if (typeof value === \"string\") return colors.yellow;\n  if (typeof value === \"number\") return colors.cyan;\n  if (typeof value === \"boolean\") return colors.magenta;\n  if (typeof value === \"function\") return colors.red;\n  if (value === null) return colors.gray;\n  if (Array.isArray(value)) return colors.blue;\n  if (typeof value === \"object\") return colors.green;\n  return colors.white;\n}\n\n/**\n * Returns a string representation of the value's type\n * Used to show simplified type information in the structure visualization\n */\nfunction getTypeString(value) {\n  if (typeof value === \"string\") return '\"\"';\n  if (typeof value === \"number\") return \"number\";\n  if (typeof value === \"boolean\") return \"bool\";\n  if (typeof value === \"function\") return \"function\";\n  if (value === null) return \"null\";\n  if (Array.isArray(value)) {\n    if (value.length) return \"[\" + getTypeString(value[0]) + \"]\";\n    else return \"[]\";\n  }\n  if (typeof value === \"object\") return \"{...}\";\n  return typeof value;\n}\n\n/**\n * Creates a colored visualization of a JSON object's structure\n * Shows the shape and types of the data rather than actual values\n * Recursively processes nested objects and arrays\n */\nexport function printJSONStructure(obj, indent = 0) {\n  const colors = getColors();\n  const pad = \"  \".repeat(indent);\n\n  // Handle primitive values and null\n  if (typeof obj !== \"object\" || obj === null) {\n    const color = getColorForType(obj);\n    return color + getTypeString(obj) + colors.reset;\n  }\n\n  // Handle arrays with special bracket formatting\n  if (Array.isArray(obj)) {\n    let result = colors.blue + \"[\" + colors.reset;\n    if (obj.length) result += \"\\n\";\n    obj.forEach((item, idx) => {\n      result += pad + \"  \" + printJSONStructure(item, indent + 1);\n      if (idx < obj.length - 1) result += \",\";\n      result += \"\\n\";\n    });\n    result += pad + colors.blue + \"]\" + colors.reset;\n    return result;\n  }\n\n  // Handle objects with special brace and property formatting\n  let result = colors.green + \"{\" + colors.reset;\n  const keys = Object.keys(obj);\n  if (keys.length) result += \"\\n\";\n  keys.forEach((key, index) => {\n    const value = obj[key];\n    const color = getColorForType(value);\n    result += pad + \"  \";\n\n    // Handle nested objects recursively\n    if (typeof value === \"object\" && value !== null && !Array.isArray(value)) {\n      result +=\n        color +\n        key +\n        colors.reset +\n        \": \" +\n        printJSONStructure(value, indent + 1);\n    }\n    // Handle nested arrays recursively\n    else if (Array.isArray(value)) {\n      result +=\n        color +\n        key +\n        colors.reset +\n        \": \" +\n        printJSONStructure(value, indent + 1);\n    }\n    // Handle primitive values\n    else {\n      result += color + key + \": \" + getTypeString(value) + colors.reset;\n    }\n    if (index < keys.length - 1) result += \",\";\n    result += \"\\n\";\n  });\n  result += pad + colors.green + \"}\" + colors.reset;\n\n  // Only log at top level of recursion\n  if (indent === 0) {\n    // console.log(result);\n  }\n  return result;\n}\n\n/**\n * Shows message in a modal overlay with scrollable message stack\n * and is easier to dismiss unlike alert() which blocks window.\n * Creates a semi-transparent overlay with a white box containing the message.\n * @param {string} msg - The message to display\n */\nexport function showAlert(msg) {\n  if (typeof document === \"undefined\") return;\n  let o = document.getElementById(\"alert-overlay\"),\n    list;\n\n  // Create overlay and alert box if they don't exist\n  if (!o) {\n    o = document.body.appendChild(document.createElement(\"div\"));\n    o.id = \"alert-overlay\";\n    o.setAttribute(\n      \"style\",\n      \"position:fixed;inset:0;z-index:9999;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center\"\n    );\n    o.innerHTML = `<div id=\"alert-box\" style=\"background:#fff;padding:1.5em 2em;border-radius:8px;box-shadow:0 2px 16px #0003;min-width:220px;max-height:80vh;position:relative;display:flex;flex-direction:column;\">\n      <button id=\"close-alert\" style=\"position:absolute;top:12px;right:20px;font-size:1.5em;background:none;border:none;cursor:pointer;color:black;\">&times;</button>\n      <div id=\"alert-list\" style=\"overflow:auto;flex:1;\"></div>\n    </div>`;\n\n    // Add click handlers to close overlay\n    o.addEventListener(\"click\", (e) => e.target == o && o.remove());\n    document.getElementById(\"close-alert\").onclick = () => o.remove();\n  }\n\n  list = o.querySelector(\"#alert-list\");\n\n  // Add new message to list\n  list.innerHTML += `<div style=\"border-bottom:1px solid #333; font-size:1.2em;margin:0.5em 0;\">${msg}</div>`;\n}\n\n/**\n * Sets up development tools for debugging API requests\n * Adds a keyboard shortcut (Ctrl+Alt+I) that shows a modal with request history\n * Each request entry shows:\n * - Request path\n * - Request details\n * - Response data\n * - Timestamp\n */\nexport function setupDevTools() {\n  // Keyboard shortcut (Ctrl+Alt+I) to toggle debug view\n  document.addEventListener(\"keydown\", (e) => {\n    if (e.key === \"i\" && e.ctrlKey) {\n      // Create HTML of the grab.log requests\n      let html = \" \";\n      for (let request of grab.log) {\n        html += `<div style=\"margin-bottom:1em; border-bottom:1px solid #ccc; padding-bottom:1em;\">\n          <b>Path:</b> ${request.path}<br>\n          <b>Request:</b> ${request.request}<br>\n          <b>Response:</b> ${JSON.stringify(request.response, null, 2)}<br>\n          <b>Time:</b> ${new Date(request.lastFetchTime).toLocaleString()}\n        </div>`;\n      }\n      showAlert(html);\n    }\n  });\n}\n\n/**\n * Displays an animated spinner in the terminal with the provided text.\n * The spinner animates in-place until the returned function is called,\n * which stops the spinner and prints a success message.\n * @param {string} text - The text to display next to the spinner animation.\n * @returns {(success?: string) => void} Stop function with optional message.\n * @example\n * const stopSpinner = showSpinnerInTerminal('Downloading...');\n * setTimeout(() => {\n *    stopSpinner('Success!');\n * }, 2000);\n */\nexport function showSpinnerInTerminal(text) {\n  let i = 0,\n    interval = setInterval(() => {\n      process.stdout.write(\n        \"\\r\" + \"‚†ã‚†ô‚†π‚†∏‚†º‚†¥‚†¶‚†ß‚†á‚†è\".split(\"\")[(i = ++i % 10)] + \" \" + text\n      );\n    }, 50);\n\n  return function (success = \"‚úî Done!\") {\n    clearInterval(interval);\n    process.stdout.write(\"\\r\" + success + \" \".repeat(text.length) + \"\\n\");\n  };\n}\n",
        "import {\n  printJSONStructure,\n  log,\n  showAlert,\n  setupDevTools,\n  type LogOptions,\n} from \"./log\";\n\n/**\n * TODO\n *  - react tests\n *  - grab error popup and dev tool\n *  - show net log in alert\n *  - progress\n *  - pagination working\n *  - tests in stackblitz\n *  - loading icons\n *  - cache revalidation\n */\n\n/**\n * ### GRAB: Generate Request to API from Browser\n * ![GrabAPILogo](https://i.imgur.com/Rwl5P3p.png)\n *\n * 1. **GRAB is the FBEST Request Manager: Functionally Brilliant, Elegantly Simple Tool**: One Function, no dependencies,\n *    minimalist syntax, [more features than alternatives](https://grab.js.org/docs/Comparisons)\n * 2. **Auto-JSON Convert**: Pass parameters and get response or error in JSON, handling other data types as is.\n * 3. **isLoading Status**: Sets `.isLoading=true` on the pre-initialized response object so you can show a \"Loading...\" in any framework\n * 4. **Debug Logging**: Adds global `log()` and prints colored JSON structure, response, timing for requests in test.\n * 5. **Mock Server Support**: Configure `window.grab.mock` for development and testing environments\n * 6. **Cancel Duplicates**: Prevent this request if one is ongoing to same path & params, or cancel the ongoing request.\n * 7. **Timeout & Retry**: Customizable request timeout, default 30s, and auto-retry on error\n * 8. **DevTools**: `Ctrl+I` overlays webpage with devtools showing all requests and responses, timing, and JSON structure.\n * 9. **Request History**: Stores all request and response data in global `grab.log` object\n * 10. **Pagination Infinite Scroll**: Built-in pagination for infinite scroll to auto-load and merge next result page, with scroll position recovery.\n * 11. **Base URL Based on Environment**: Configure `grab.defaults.baseURL` once at the top, overide with `SERVER_API_URL` in `.env`.\n * 12. **Frontend Cache**: Set cache headers and retrieve from frontend memory for repeat requests to static data.\n * 13. **Regrab On Error**: Regrab on timeout error, or on window refocus, or on network change, or on stale data.\n * 14. **Framework Agnostic**: Alternatives like TanStack work only in component initialization and depend on React & others.\n * 15. **Globals**: Adds to window in browser or global in Node.js so you only import once: `grab()`, `log()`, `grab.log`, `grab.mock`, `grab.defaults`\n * 16. **TypeScript Tooltips**: Developers can hover over option names and autocomplete TypeScript.\n * 17. **Request Stategies**: [üéØ Examples](https://grab.js.org/docs/Examples) show common stategies like debounce, repeat, proxy, unit tests, interceptors, file upload, etc\n * 18. **Rate Limiting**: Built-in rate limiting to prevent multi-click cascading responses, require to wait seconds between requests.\n * 19. **Repeat**: Repeat request this many times, or repeat every X seconds to poll for updates.\n * 20. **Loading Icons**: Import from `grab-url/icons` to get enhanced animated loading icons.\n *\n * @param {string} path The full URL path OR relative path on this server after `grab.defaults.baseURL`\n * @param {object} [options={}] Request params for GET or body for POST/PUT/PATCH and utility options\n * @param {string} [options.method] default=\"GET\" The HTTP method to use\n * @param {object} [options.response] Pre-initialized object which becomes response JSON, no need for `.data`.\n *  isLoading and error may also be set on this object. May omit and use return if load status is not needed.\n * @param {boolean} [options.cancelOngoingIfNew]  default=false Cancel previous requests to same path\n * @param {boolean} [options.cancelNewIfOngoing] default=false Cancel if a request to path is in progress\n * @param {boolean} [options.cache] default=false Whether to cache the request and from frontend cache\n * @param {boolean} [options.debug] default=false Whether to log the request and response\n * @param {number} [options.timeout] default=30 The timeout for the request in seconds\n * @param {number} [options.cacheForTime] default=60 Seconds to consider data stale and invalidate cache\n * @param {number} [options.rateLimit] default=0 If set, how many seconds to wait between requests\n * @param {string} [options.baseURL] default='/api/' base url prefix, override with SERVER_API_URL env\n * @param {boolean} [options.setDefaults] default=false Pass this with options to set\n *  those options as defaults for all requests.\n * @param {number} [options.retryAttempts] default=0 Retry failed requests this many times\n * @param {array} [options.infiniteScroll] default=null [page key, response field to concatenate, element with results]\n * @param {number} [options.repeat] default=0 Repeat request this many times\n * @param {number} [options.repeatEvery] default=null Repeat request every seconds\n * @param {function} [options.logger] default=log Custom logger to override the built-in color JSON log()\n * @param {function} [options.onRequest] Set with defaults to modify each request data.\n *  Takes and returns in order: path, response, params, fetchParams\n * @param {function} [options.onResponse] Set with defaults to modify each request data.\n *  Takes and returns in order: path, response, params, fetchParams\n * @param {function} [options.onStream] Set with defaults to process the response as a stream (i.e., for instant unzip)\n * @param {function} [options.onError] Set with defaults to modify the error data. Takes: error, path, params\n * @param {number} [options.debounce] default=0 Seconds to debounce request, wait to execute so that other requests may override\n * @param {boolean} [options.regrabOnStale] default=false Refetch when cache is past cacheForTime\n * @param {boolean} [options.regrabOnFocus] default=false Refetch on window refocus\n * @param {boolean} [options.regrabOnNetwork] default=false Refetch on network change\n * @param {any} [...params] All other params become GET params, POST body, and other methods.\n * @returns {Promise<Object>} The response object with resulting data or .error if error.\n * @author [vtempest (2025)](https://github.com/vtempest/GRAB-URL)\n * @see  [üéØ Examples](https://grab.js.org/docs/Examples) [üìë Docs](https://grab.js.org)\n * @example import grab from 'grab-url';\n * let res = {};\n * await grab('search', {\n *   response: res,\n *   query: \"search words\"\n * })\n */\nexport default async function grab<TResponse = any, TParams = any>(\n  path: string,\n  options: GrabOptions<TResponse, TParams>\n): Promise<GrabResponse<TResponse>> {\n  var {\n    headers,\n    response = {} as any, // Pre-initialized object to set the response in. isLoading and error are also set on this object.\n    method = options.post // set post: true for POST, omit for GET\n      ? \"POST\"\n      : options.put\n      ? \"PUT\"\n      : options.patch\n      ? \"PATCH\"\n      : \"GET\",\n    cache = false, // Enable/disable frontend caching\n    cacheForTime = 60, // Seconds to consider data stale and invalidate cache\n    timeout = 30, // Request timeout in seconds\n    baseURL = (typeof process !== \"undefined\" && process.env.SERVER_API_URL) ||\n      \"/api/\", // Use env var or default to /api/\n    cancelOngoingIfNew = false, // Cancel previous request for same path\n    cancelNewIfOngoing = false, // Don't make new request if one is ongoing\n    rateLimit = 0, // Minimum seconds between requests\n    debug = false, // Auto-enable debug on localhost\n    // typeof window !== \"undefined\" && window?.location?.hostname?.includes(\"localhost\"),\n    infiniteScroll = null, // page key, response field to concatenate, element with results\n    setDefaults = false, // Set these options as defaults for future requests\n    retryAttempts = 0, // Retry failed requests once\n    logger = log, // Custom logger to override the built-in color JSON log()\n    onRequest = null, // Hook to modify request data before request is made\n    onResponse = null, // Hook to modify request data after request is made\n    onError = null, // Hook to modify request data after request is made\n    onStream = null, // Hook to process the response as a stream (i.e., for instant unarchiving)\n    repeatEvery = null, // Repeat request every seconds\n    repeat = 0, // Repeat request this many times\n    debounce = 0, // Seconds to debounce request, wait to execute so that other requests may override\n    regrabOnStale = false, // Refetch when cache is past cacheForTime\n    regrabOnFocus = false, // Refetch on window refocus\n    regrabOnNetwork = false, // Refetch on network change\n    post = false,\n    put = false,\n    patch = false,\n    body = null,\n    ...params  // All other params become request params/query\n  } = {\n    // Destructure options with defaults, merging with any globally set defaults\n    ...(typeof window !== \"undefined\"\n      ? window?.grab?.defaults\n      : (global || globalThis)?.grab?.defaults || {}),\n    ...options,\n  };\n\n  // Handle URL construction\n  // Ensures proper joining of baseURL and path\n  let s = (t) => path.startsWith(t);\n  if (s(\"http:\") || s(\"https:\")) baseURL = \"\";\n  else if (!s(\"/\") && !baseURL.endsWith(\"/\")) path = \"/\" + path;\n  else if (s(\"/\") && baseURL.endsWith(\"/\")) path = path.slice(1);\n\n  try {\n    //handle debounce\n    if (debounce > 0)\n      return (await debouncer(async () => {\n        await grab(path, { ...options, debounce: 0 });\n      }, debounce * 1000)) as GrabResponse;\n\n    // Handle repeat options:\n    // - repeat: Makes the same request multiple times sequentially\n    // - repeatEvery: Makes the request periodically on an interval\n    if (repeat > 1) {\n      for (let i = 0; i < repeat; i++) {\n        await grab(path, { ...options, repeat: 0 });\n      }\n      return response;\n    }\n    if (repeatEvery) {\n      setInterval(async () => {\n        await grab(path, { ...options, repeat: 0, repeatEvery: null });\n      }, repeatEvery * 1000);\n      return response;\n    }\n\n    // Store the provided options as new defaults if setDefaults flag is set\n    // This allows configuring default options that apply to all future requests\n    if (options?.setDefaults) {\n      if (typeof window !== \"undefined\")\n        window.grab.defaults = { ...options, setDefaults: undefined };\n      else if (typeof (global || globalThis).grab !== \"undefined\")\n        (global || globalThis).grab.defaults = {\n          ...options,\n          setDefaults: undefined,\n        };\n\n      return;\n    }\n\n    // regrab on stale, on window refocus, on network\n    if (typeof window !== \"undefined\") {\n      const regrab = async () => await grab(path, { ...options, cache: false });\n      if (regrabOnStale && cache) setTimeout(regrab, 1000 * cacheForTime);\n      if (regrabOnNetwork) window.addEventListener(\"online\", regrab);\n      if (regrabOnFocus) {\n        window.addEventListener(\"focus\", regrab);\n        document.addEventListener(\"visibilitychange\", async () => {\n          if (document.visibilityState === \"visible\") await regrab();\n        });\n      }\n    }\n\n    // Handle response parameter which can be either an object to populate\n    // or a function to call with results (e.g. React setState)\n    let resFunction = typeof response === \"function\" ? response : null;\n    if (!response || resFunction) response = {};\n\n    var [paginateKey, paginateResult, paginateElement] = infiniteScroll || [];\n\n    // Configure infinite scroll behavior if enabled\n    // Attaches scroll listener to specified element that triggers next page load\n    if (infiniteScroll?.length && typeof paginateElement !== \"undefined\"\n         && typeof window !== \"undefined\") {\n      let paginateDOM =\n        typeof paginateElement === \"string\"\n          ? document.querySelector(paginateElement)\n          : paginateElement;\n\n      if (!paginateDOM) log(\"paginateDOM not found\", { color: \"red\" });\n\n      if (window.scrollListener && typeof paginateDOM !== \"undefined\") \n        paginateDOM.removeEventListener(\"scroll\", window.scrollListener);\n\n      // Your modified scroll listener with position saving\n      window.scrollListener = async (event) => {\n        const t = event.target as HTMLElement;\n        \n        // Save scroll position whenever user scrolls\n        localStorage.setItem(\n          \"scroll\",\n          JSON.stringify([t.scrollTop, t.scrollLeft, paginateElement])\n        );\n\n        if (t.scrollHeight - t.scrollTop <= t.clientHeight + 200) {\n          await grab(path, {\n            ...options,\n            cache: false,\n            [paginateKey]: priorRequest?.currentPage + 1,\n          });\n        }\n      };\n\n      if (paginateDOM) \n          paginateDOM.addEventListener(\"scroll\", window.scrollListener);\n    }\n\n    // Check request history for a previous request with same path/params\n    // Used for caching and pagination. Ignores pagination params when comparing.\n    let paramsAsText = JSON.stringify(\n      paginateKey ? { ...params, [paginateKey]: undefined } : params\n    );\n    let priorRequest = grab?.log?.find(\n      (e) => e.request == paramsAsText && e.path == path\n    );\n\n    // Handle response data management based on pagination settings\n    if (!paginateKey) {\n      // Clear any existing response data\n      for (let key of Object.keys(response)) response[key] = undefined;\n\n      // For non-paginated requests:\n      // Return cached response if caching enabled and identical request exists\n      // after returning cache, proceed with call to revalidate ensure data is up to date\n      if (\n        cache &&\n        (!cacheForTime ||\n          priorRequest?.lastFetchTime > Date.now() - 1000 * cacheForTime)\n      ) {\n        // set response to cache data\n        for (let key of Object.keys(priorRequest.res))\n          response[key] = priorRequest.res[key];\n        if (resFunction) response = resFunction(response);\n\n        // if (!cacheValidate)  return response;\n      }\n    } else {\n      // For paginated requests:\n      // Track current page number and append results to existing data\n      let pageNumber =\n        priorRequest?.currentPage + 1 || params?.[paginateKey] || 1;\n\n      // Clear response if this is a new request with new params\n      if (!priorRequest) {\n        response[paginateResult] = [];\n        pageNumber = 1;\n      }\n\n      // Update page tracking\n      if (priorRequest) priorRequest.currentPage = pageNumber;\n      params = { ...params, [paginateKey]: pageNumber };\n    }\n\n    // Set loading state on response object\n    if (resFunction) resFunction({ isLoading: true });\n    else if (typeof response === \"object\") response.isLoading = true;\n\n    if (resFunction) response = resFunction(response);\n\n    // Enforce rate limiting between requests if configured\n    if (\n      rateLimit > 0 &&\n      priorRequest?.lastFetchTime &&\n      priorRequest.lastFetchTime > Date.now() - 1000 * rateLimit\n    )\n      throw new Error(`Fetch rate limit exceeded for ${path}. \n        Wait ${rateLimit}s between requests.`);\n\n    // Handle request cancellation based on configuration:\n    // - cancelOngoingIfNew: Cancels any in-progress request for same path\n    // - cancelNewIfOngoing: Prevents new request if one is already in progress\n    if (priorRequest?.controller)\n      if (cancelOngoingIfNew) priorRequest.controller.abort();\n      else if (cancelNewIfOngoing) return { isLoading: true } as GrabResponse;\n\n    // Track new request in history log\n    if (typeof grab.log != \"undefined\")\n      grab.log?.unshift({\n        path,\n        request: paramsAsText,\n        lastFetchTime: Date.now(),\n        controller: new AbortController(),\n      });\n\n    // Configure fetch request parameters including headers, cache settings,\n    // and timeout/cancellation signals\n    let fetchParams = {\n      method,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        ...headers,\n      },\n      body: params.body,\n      redirect: \"follow\" as RequestRedirect,\n      cache: cache ? \"force-cache\" : (\"no-store\" as RequestCache),\n      signal: cancelOngoingIfNew\n        ? grab.log[0]?.controller?.signal\n        : AbortSignal.timeout(timeout * 1000),\n    } as RequestInit;\n\n    // Format request parameters based on HTTP method\n    // POST/PUT/PATCH send data in request body\n    // GET/DELETE append data as URL query parameters\n    let paramsGETRequest = \"\";\n    if ([\"POST\", \"PUT\", \"PATCH\"].includes(method))\n      fetchParams.body = params.body || JSON.stringify(params);\n    else\n      paramsGETRequest =\n        (Object.keys(params).length ? \"?\" : \"\") +\n        new URLSearchParams(params).toString();\n\n    // Execute pre-request hook if configured\n    // Allows modifying request data before sending\n    if (typeof onRequest === \"function\")\n      [path, response, params, fetchParams] = onRequest(\n        path,\n        response,\n        params,\n        fetchParams\n      );\n\n    // Process request through mock handler if configured\n    // Otherwise make actual API request\n    let res = null,\n      startTime = new Date(),\n      mockHandler = grab.mock?.[path] as GrabMockHandler;\n\n    let wait = (s) => new Promise((res) => setTimeout(res, s * 1000 || 0));\n\n    if (\n      mockHandler &&\n      (!mockHandler.params || mockHandler.method == method) &&\n      (!mockHandler.params ||\n        paramsAsText == JSON.stringify(mockHandler.params))\n    ) {\n      await wait(mockHandler.delay);\n\n      res =\n        typeof mockHandler.response === \"function\"\n          ? mockHandler.response(params)\n          : mockHandler.response;\n    } else {\n      // Make actual API request and handle response based on content type\n      res = await fetch(baseURL + path + paramsGETRequest, fetchParams).catch(\n        (e) => {\n          throw new Error(e.message);\n        }\n      );\n\n      if (!res.ok)\n        throw new Error(`HTTP error: ${res.status} ${res.statusText}`);\n\n      // Convert browser ReadableStream to Node.js stream\n      let type = res.headers.get(\"content-type\");\n\n      if (onStream) await onStream(res.body);\n      else\n        res = await (type\n          ? type.includes(\"application/json\")\n            ? res && res.json()\n            : type.includes(\"application/pdf\") ||\n              type.includes(\"application/octet-stream\")\n            ? res.blob()\n            : res.text()\n          : res.json()\n        ).catch((e) => {\n          throw new Error(\"Error parsing response: \" + e);\n        });\n    }\n\n    // Execute post-request hook if configured\n    // Allows modifying response data before processing\n    if (typeof onResponse === \"function\")\n      [path, response, params, fetchParams] = onResponse(\n        path,\n        response,\n        params,\n        fetchParams\n      );\n\n    // Clear request tracking states\n    if (resFunction) resFunction({ isLoading: undefined });\n    else if (typeof response === \"object\") delete response?.isLoading;\n\n    delete priorRequest?.controller;\n\n    // Log debug information if enabled\n    // Includes request details, timing, and response structure\n    const elapsedTime = (\n      (Number(new Date()) - Number(startTime)) /\n      1000\n    ).toFixed(1);\n    if (debug) {\n      logger(\n        \"Path:\" +\n          baseURL +\n          path +\n          paramsGETRequest +\n          \"\\n\" +\n          JSON.stringify(options, null, 2) +\n          \"\\nTime: \" +\n          elapsedTime +\n          \"s\\nResponse: \" +\n          printJSONStructure(res)\n      );\n      // console.log(res);\n    }\n\n    // if (typeof res === \"undefined\") return;\n\n    // Update response object with results\n    // For paginated requests, concatenates with existing results\n    if (typeof res === \"object\") {\n      for (let key of Object.keys(res))\n        response[key] =\n          paginateResult == key && response[key]?.length\n            ? [...response[key], ...res[key]]\n            : res[key];\n\n      if (typeof response !== \"undefined\") response.data = res; // for axios compat\n    } else if (resFunction) resFunction({ data: res, ...res });\n    else if (typeof response === \"object\") response.data = res;\n\n    // Store request/response in history log\n    if (typeof grab.log != \"undefined\")\n      grab.log?.unshift({\n        path,\n        request: JSON.stringify({ ...params, paginateKey: undefined }),\n        response,\n        lastFetchTime: Date.now(),\n      });\n\n    if (resFunction) response = resFunction(response);\n\n    return response;\n  } catch (error) {\n    // Handle any errors that occurred during request processing\n    let errorMessage =\n      \"Error: \" + error.message + \"\\nPath:\" + baseURL + path + \"\\n\";\n    // JSON.stringify(params);\n\n    // if onError hook is passed\n    if (typeof onError === \"function\")\n      onError(error.message, baseURL + path, params);\n\n    // Retry request if retries are configured and attempts remain\n    if (options.retryAttempts > 0)\n      return await grab(path, {\n        ...options,\n        retryAttempts: --options.retryAttempts,\n      });\n\n    // Update error state in response object\n    // Do not show errors for duplicate aborted requests\n    if (!error.message.includes(\"signal\") && options.debug) {\n      logger(errorMessage, { color: \"red\" });\n      if (debug && typeof document !== \"undefined\") showAlert(errorMessage);\n    }\n    response.error = error.message;\n    if (typeof response === \"function\") {\n      response.data = response({ isLoading: undefined, error: error.message });\n      response = response.data;\n    } else delete response?.isLoading;\n\n    // Log error in request history\n    if (typeof grab.log != \"undefined\")\n      grab.log?.unshift({\n        path,\n        request: JSON.stringify(params),\n        error: error.message,\n      });\n\n    // if (typeof options.response === \"function\")\n    //   response = options.response(response);\n    return response;\n  }\n}\n\n/**\n * Creates a new instance of grab with default options\n * to apply to all requests made by this instance\n * @param {Object} defaults - options for all requests by instance\n * @returns {Function} grab() function using those options\n */\ngrab.instance =\n  (defaults = {}) =>\n  (path, options = {}) =>\n    grab(path, { ...defaults, ...options });\n\n// delays execution so that future calls may override and only executes last one\nconst debouncer = async (func, wait) => {\n  let timeout;\n  return async function executedFunction(...args) {\n    const later = async () => {\n      clearTimeout(timeout);\n      await func(...args);\n    };\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  };\n};\n\n// Add globals to window in browser, or global in Node.js\nif (typeof window !== \"undefined\") {\n  window.log = log;\n  window.grab = grab;\n\n  window.grab.log = []; \n  window.grab.mock = {};\n  window.grab.defaults = {};\n\n  //Ctrl+I setup dev tools\n  setupDevTools();\n\n  // Restore scroll position when page loads or component mounts\n  document.addEventListener(\"DOMContentLoaded\", () => {\n    let [scrollTop, scrollLeft, paginateElement] =\n      JSON.parse(localStorage.getItem(\"scroll\")) || [];\n    if (!scrollTop) return;\n    document.querySelector(paginateElement).scrollTop = scrollTop;\n    document.querySelector(paginateElement).scrollLeft = scrollLeft;\n  });\n} else if (typeof global !== \"undefined\") {\n  grab.log = [];\n  grab.mock = {};\n  grab.defaults = {};\n  global.log = log;\n  global.grab = grab.instance();\n} else if (typeof globalThis !== \"undefined\") {\n  grab.log = [];\n  grab.mock = {};\n  grab.defaults = {};\n  globalThis.log = log;\n  globalThis.grab = grab.instance();\n}\n\n/***************** TYPESCRIPT INTERFACES *****************/\n\n// Core response object that gets populated with API response data\nexport type GrabResponse<TResponse = any> = TResponse & {\n  /** Indicates if request is currently in progress */\n  isLoading?: boolean;\n  /** Error message if request failed */\n  error?: string;\n  /** Binary or text response data (JSON is set to the root)*/\n  data?: TResponse | any;\n  /** The actual response data - type depends on API endpoint */\n  [key: string]: unknown;\n};\n\nexport type GrabOptions<TResponse = any, TParams = any> = TParams & {\n  /** include headers and authorization in the request */\n  headers?: Record<string, string>;\n  /** Pre-initialized object which becomes response JSON, no need for .data */\n  response?: TResponse | ((params: TParams) => TResponse) | any;\n  /** default=\"GET\" The HTTP method to use */\n  method?: \"GET\" | \"POST\" | \"PUT\" | \"PATCH\" | \"DELETE\" | \"OPTIONS\" | \"HEAD\";\n  /** default=false Whether to cache the request and from frontend cache */\n  cache?: boolean;\n  /** default=60 Seconds to consider data stale and invalidate cache */\n  cacheForTime?: number;\n  /** default=30 The timeout for the request in seconds */\n  timeout?: number;\n  /** default='/api/' base url prefix, override with SERVER_API_URL env */\n  baseURL?: string;\n  /** default=true Cancel previous requests to same path */\n  cancelOngoingIfNew?: boolean;\n  /** default=false Cancel if a request to path is in progress */\n  cancelNewIfOngoing?: boolean;\n  /** default=false If set, how many seconds to wait between requests */\n  rateLimit?: number;\n  /** default=false Whether to log the request and response */\n  debug?: boolean;\n  /** default=null [page key, response field to concatenate, element with results] */\n  infiniteScroll?: [string, string, string | HTMLElement];\n  /** default=false Pass this with options to set those options as defaults for all requests */\n  setDefaults?: boolean;\n  /** default=0 Retry failed requests this many times */\n  retryAttempts?: number;\n  /** default=log Custom logger to override the built-in color JSON log() */\n  logger?: (...args: any[]) => void;\n  /** Set with defaults to modify each request data. Takes and returns in order: path, response, params, fetchParams */\n  onRequest?: (...args: any[]) => any;\n  /** Set with defaults to modify each request data. Takes and returns in order: path, response, params, fetchParams */\n  onResponse?: (...args: any[]) => any;\n  /** Set with defaults to modify each request data. Takes and returns in order: error, path, params */\n  onError?: (...args: any[]) => any;\n  /** Set with defaults to process the response as a stream (i.e., for instant unzip) */\n  onStream?: (...args: any[]) => any;\n  /** default=0 Repeat request this many times */\n  repeat?: number;\n  /** default=null Repeat request every seconds */\n  repeatEvery?: number;\n  /** default=0 Seconds to debounce request, wait to execute so that other requests may override */\n  debounce?: number;\n  /** default=false Refetch when cache is past cacheForTime */\n  regrabOnStale?: boolean;\n  /** default=false Refetch on window refocus */\n  regrabOnFocus?: boolean;\n  /** default=false Refetch on network change */\n  regrabOnNetwork?: boolean;\n  /** shortcut for method: \"POST\" */\n  post?: boolean;\n  /** shortcut for method: \"PUT\" */\n  put?: boolean;\n  /** shortcut for method: \"PATCH\" */\n  patch?: boolean;\n  /** default=null The body of the POST/PUT/PATCH request (can be passed into main)*/\n  body?: any;\n  /** All other params become GET params, POST body, and other methods */\n  [key: string]: TParams | any;\n};\n\n// Combined options and parameters interface\n\n// Mock server configuration for testing\nexport interface GrabMockHandler<TParams = any, TResponse = any> {\n  /** Mock response data or function that returns response */\n  response: TResponse | ((params: TParams) => TResponse);\n  /** HTTP method this mock should respond to */\n  method?: \"GET\" | \"POST\" | \"PUT\" | \"PATCH\" | \"DELETE\" | \"OPTIONS\" | \"HEAD\";\n  /** Request parameters this mock should match */\n  params?: TParams;\n  /** Delay in seconds before returning mock response */\n  delay?: number;\n}\n\n// Request log entry for debugging and history\nexport interface GrabLogEntry {\n  /** API path that was requested */\n  path: string;\n  /** Stringified request parameters */\n  request: string;\n  /** Response data (only present for successful requests) */\n  response?: any;\n  /** Error message (only present for failed requests) */\n  error?: string;\n  /** Timestamp when request was made */\n  lastFetchTime: number;\n  /** Abort controller for request cancellation */\n  controller?: AbortController;\n  /** Current page number for paginated requests */\n  currentPage?: number;\n}\n\n// Global grab configuration and state\nexport interface GrabGlobal {\n  /** Default options applied to all requests */\n  defaults?: Partial<GrabOptions>;\n  /** Request history and debugging info */\n  log?: GrabLogEntry[];\n  /** Mock server handlers for testing */\n  mock?: Record<string, GrabMockHandler>;\n  /** Create a separate instance of grab with separate default options */\n  instance?: (defaultOptions?: Partial<GrabOptions>) => GrabFunction;\n}\n\n// Main grab function signature with overloads for different use cases\nexport interface GrabFunction {\n  /**\n   * ### GRAB: Generate Request to API from Browser\n   * ![grabAPILogo](https://i.imgur.com/Rwl5P3p.png)\n   * Make API request with path\n   * @returns {Promise<Object>} The response object with resulting data or .error if error.\n   * @author [vtempest (2025)](https://github.com/vtempest/GRAB-URL)\n   * @see  [üéØ Examples](https://grab.js.org/docs/Examples) [üìë Docs](https://grab.js.org/lib)\n   */\n  <TResponse = any, TParams = Record<string, any>>(path: string, options?: GrabOptions<TResponse, TParams>): Promise<\n    GrabResponse<TResponse>\n  >;\n\n  /**\n   * ### GRAB: Generate Request to API from Browser\n   * ![grabAPILogo](https://i.imgur.com/Rwl5P3p.png)\n   * Make API request with path and options/parameters\n   * @returns {Promise<Object>} The response object with resulting data or .error if error.\n   * @author [vtempest (2025)](https://github.com/vtempest/GRAB-URL)\n   * @see  [üéØ Examples](https://grab.js.org/docs/Examples) [üìë Docs](https://grab.js.org/lib)\n   */\n  <TResponse = any, TParams = Record<string, any>>(\n    path: string,\n    config: GrabOptions<TResponse, TParams>\n  ): Promise<GrabResponse<TResponse>>;\n\n  /** Default options applied to all requests */\n  defaults?: Partial<GrabOptions>;\n\n  /** Request history and debugging info for all requests */\n  log?: GrabLogEntry[];\n\n  /** Mock server handlers for testing */\n  mock?: Record<string, GrabMockHandler>;\n\n  /** Create a separate instance of grab with separate default options */\n  instance?: (defaultOptions?: Partial<GrabOptions>) => GrabFunction;\n}\n\n// Log function for debugging\nexport interface LogFunction {\n  /**\n   * Log messages with custom styling\n   * @param message - Message to log (string or object)\n   */\n  (message: string | object, options?: LogOptions): void;\n}\n\n// Utility function to describe JSON structure\nexport interface printJSONStructureFunction {\n  /**\n   * Generate TypeDoc-like description of JSON object structure\n   * @param obj - The JSON object to describe\n   * @returns String representation of object structure\n   */\n  (obj: any): string;\n}\n\ndeclare global {\n  // Browser globals\n  interface Window {\n    grab: GrabFunction;\n    log: LogFunction;\n    scrollListener: (event: Event) => void; // replace 'any' with the actual type if you know it (e.g., a function type)\n  }\n\n  // Node.js globals\n  namespace NodeJS {\n    interface Global {\n      grab: GrabFunction;\n      log: LogFunction;\n    }\n  }\n\n  // Global variables available after script inclusion\n  var log: LogFunction;\n  var grab: GrabFunction;\n}\n\nexport { grab, log, showAlert, printJSONStructure };\n"
    ],
    "names": [
        "log",
        "message",
        "options",
        "color",
        "style",
        "hideInProduction",
        "startSpinner",
        "stopSpinner",
        "colors",
        "getColors",
        "window",
        "location",
        "hostname",
        "includes",
        "printJSONStructure",
        "JSON",
        "stringify",
        "process",
        "reset",
        "i",
        "global",
        "globalThis",
        "interval",
        "setInterval",
        "stdout",
        "write",
        "split",
        "clearInterval",
        "repeat",
        "length",
        "match",
        "console",
        "debug",
        "colorMap",
        "black",
        "red",
        "green",
        "yellow",
        "blue",
        "magenta",
        "cyan",
        "white",
        "gray",
        "brightRed",
        "brightGreen",
        "brightYellow",
        "brightBlue",
        "brightMagenta",
        "brightCyan",
        "brightWhite",
        "bgRed",
        "bgGreen",
        "bgYellow",
        "bgBlue",
        "bgMagenta",
        "bgCyan",
        "bgWhite",
        "bgGray",
        "format",
        "name",
        "ansiCode",
        "hexCode",
        "Object",
        "entries",
        "getColorForType",
        "value",
        "Array",
        "isArray",
        "getTypeString",
        "obj",
        "indent",
        "pad",
        "result",
        "forEach",
        "item",
        "idx",
        "keys",
        "key",
        "index",
        "showAlert",
        "msg",
        "document",
        "list",
        "o",
        "getElementById",
        "body",
        "appendChild",
        "createElement",
        "id",
        "setAttribute",
        "innerHTML",
        "addEventListener",
        "e",
        "target",
        "remove",
        "onclick",
        "querySelector",
        "async",
        "grab",
        "path",
        "headers",
        "response",
        "method",
        "post",
        "put",
        "patch",
        "cache",
        "cacheForTime",
        "timeout",
        "baseURL",
        "env",
        "SERVER_API_URL",
        "cancelOngoingIfNew",
        "cancelNewIfOngoing",
        "rateLimit",
        "infiniteScroll",
        "setDefaults",
        "retryAttempts",
        "logger",
        "onRequest",
        "onResponse",
        "onError",
        "onStream",
        "repeatEvery",
        "debounce",
        "regrabOnStale",
        "regrabOnFocus",
        "regrabOnNetwork",
        "params",
        "_a",
        "defaults",
        "_c",
        "_b",
        "s",
        "t",
        "startsWith",
        "endsWith",
        "slice",
        "debouncer",
        "regrab",
        "setTimeout",
        "visibilityState",
        "resFunction",
        "paginateKey",
        "paginateResult",
        "paginateElement",
        "paginateDOM",
        "scrollListener",
        "removeEventListener",
        "event",
        "localStorage",
        "setItem",
        "scrollTop",
        "scrollLeft",
        "scrollHeight",
        "clientHeight",
        "priorRequest",
        "currentPage",
        "paramsAsText",
        "find",
        "request",
        "pageNumber",
        "lastFetchTime",
        "Date",
        "now",
        "res",
        "isLoading",
        "Error",
        "controller",
        "abort",
        "unshift",
        "AbortController",
        "fetchParams",
        "Accept",
        "redirect",
        "signal",
        "AbortSignal",
        "paramsGETRequest",
        "URLSearchParams",
        "toString",
        "startTime",
        "mockHandler",
        "mock",
        "wait",
        "Promise",
        "fetch",
        "catch",
        "ok",
        "status",
        "statusText",
        "type",
        "get",
        "json",
        "blob",
        "text",
        "delay",
        "elapsedTime",
        "Number",
        "toFixed",
        "_i",
        "data",
        "error",
        "errorMessage",
        "instance",
        "func",
        "args",
        "clearTimeout",
        "ctrlKey",
        "html",
        "toLocaleString",
        "parse",
        "getItem"
    ],
    "mappings": "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"
}
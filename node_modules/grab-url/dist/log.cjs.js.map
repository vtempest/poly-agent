{"version":3,"file":"log.cjs.js","sources":["../src/log-json.ts"],"sourcesContent":["/**\n * ### Colorized Log With JSON Structure\n * ![Debug log](https://i.imgur.com/R8Qp6Vg.png)\n * Logs messages to the console with custom styling,\n * prints JSON with description of structure layout,\n * and showing debug output in development only.\n * @param {string|object} message - The message to log. If an object is provided, it will be stringified.\n * @param {string|string[]} [options.style] default='color: blue; font-size: 11pt;' - CSS style string\n * @param {boolean} [options.hideInProduction] -  default = auto-detects based on hostname.\n *  If true, uses `console.debug` (hidden in production). If false, uses `console.log`.\n *\n */\nexport function log(message: string|object  = \"\", options: LogOptions = {}) {\n  let {\n    color,\n    style = \"color:rgb(54, 165, 220); font-size: 10pt;\",\n    hideInProduction = undefined,\n    startSpinner = false,\n    stopSpinner = false,\n  } = options;\n  const colors = getColors();\n\n  // Auto-detect if we should hide logs in production based on hostname\n  if (typeof hideInProduction === \"undefined\")\n    hideInProduction =\n      typeof window !== \"undefined\" &&\n      window?.location.hostname.includes(\"localhost\");\n\n  // For objects, print both the structure visualization and full JSON\n  if (typeof message === \"object\")\n    message =\n      printJSONStructure(message) + \"\\n\\n\" + JSON.stringify(message, null, 2);\n\n  // change color: [red] to color: red if only one\n  if (Array.isArray(color) && color.length == 1) color = color[0];\n\n  //colorize in terminal (%c is only in browser but we polyfill it)\n  if (color && typeof process !== undefined)\n    if (message.includes(\"%c\") && Array.isArray(color)) // replace each c with color[i]\n      message = message.replace(/%c/g, (match, index) => colors[color[index]] || \"\");\n    else if (color && typeof color === \"string\")\n      message = (colors[color] || \"\") + message + colors.reset;\n\n\n\n  //  Displays an animated spinner in the terminal with the provided text.\n  var i = 0;\n\n  if (startSpinner)\n    (global || globalThis).interval = setInterval(() => {\n      process.stdout.write(\n        (Array.isArray(color) ? colors[color[0]] : colors[color] || \"\") +\n          \"\\r\" +\n          \"⠋⠙⠹⠸⠼⠴⠦⠧⠇⠏\".split(\"\")[(i = ++i % 10)] +\n          \" \" +\n          message +\n          colors.reset\n      );\n    }, 50);\n  else if (stopSpinner) {\n    clearInterval((global || globalThis).interval);\n    process.stdout.write(\n      \"\\r\" + (message || \" \") + \" \".repeat(message.length + 20) + \"\\n\"\n    );\n  } else if (typeof style === \"string\") {\n    // check if style is a one word color code or named color\n    //test if style is valid as a CSS color name\n    if (style.split(\" \").length == 1 || color) {\n      style = `color: ${color || style}; font-size: 11pt;`;\n    } else {\n      // check if style is valid as a CSS color code\n      if (style.match(/^#[0-9a-fA-F]{6}$/)) {\n        style = `color: ${style}; font-size: 11pt;`;\n      }\n    }\n    // Use console.debug for production-hidden logs, console.log otherwise\n    if (hideInProduction)\n      console.debug((style ? \"%c\" : \"\") + (message || \"\"), style);\n    else console.log((style ? \"%c\" : \"\") + (message || \"\"), style);\n  } else if (typeof style === \"object\") console.log(message, ...(style as any));\n  return true;\n}\n\nexport interface LogOptions {\n  /** CSS style string or array of CSS strings for browser console styling */\n  style?: string | string[];\n  /** Optional color name or code for terminal environments */\n  color?: ColorName | ColorName[] | string | string[] ;\n  /** If true, hides log in production (auto-detects by hostname if undefined) */\n  hideInProduction?: boolean;\n  /** Start a spinner (for CLI tools, optional) */\n  startSpinner?: boolean;\n  /** Stop a spinner (for CLI tools, optional) */\n  stopSpinner?: boolean;\n}\n\n/**\n * Available color names\n */\nexport enum ColorName {\n  RESET = 'reset',\n  BLACK = 'black',\n  RED = 'red',\n  GREEN = 'green',\n  YELLOW = 'yellow',\n  BLUE = 'blue',\n  MAGENTA = 'magenta',\n  CYAN = 'cyan',\n  WHITE = 'white',\n  GRAY = 'gray',\n  BRIGHT_RED = 'brightRed',\n  BRIGHT_GREEN = 'brightGreen',\n  BRIGHT_YELLOW = 'brightYellow',\n  BRIGHT_BLUE = 'brightBlue',\n  BRIGHT_MAGENTA = 'brightMagenta',\n  BRIGHT_CYAN = 'brightCyan',\n  BRIGHT_WHITE = 'brightWhite',\n  BG_RED = 'bgRed',\n  BG_GREEN = 'bgGreen',\n  BG_YELLOW = 'bgYellow',\n  BG_BLUE = 'bgBlue',\n  BG_MAGENTA = 'bgMagenta',\n  BG_CYAN = 'bgCyan',\n  BG_WHITE = 'bgWhite',\n  BG_GRAY = 'bgGray',\n  BG_BLACK = 'bgBlack',\n  BG_BRIGHT_RED = 'bgBrightRed',\n  BG_BRIGHT_GREEN = 'bgBrightGreen',\n  BG_BRIGHT_YELLOW = 'bgBrightYellow',\n  BG_BRIGHT_BLUE = 'bgBrightBlue',\n  BG_BRIGHT_MAGENTA = 'bgBrightMagenta',\n  BG_BRIGHT_CYAN = 'bgBrightCyan',\n  BG_BRIGHT_WHITE = 'bgBrightWhite',\n}\n\n/**\n * Color mapping with ANSI codes and HTML hex values\n * @type {Record<ColorName, [number, string]>}\n * @description Maps color names to [ansiCode, hexValue] pairs\n * - ansiCode: ANSI escape sequence number for terminal colors\n * - hexValue: Hex color value (without #) for HTML/CSS\n */\nconst colorMap: Record<ColorName, [number, string]> = {\n  [ColorName.RESET]: [0, '000000'],\n  [ColorName.BLACK]: [30, '000000'],\n  [ColorName.RED]: [31, 'ff0000'],\n  [ColorName.GREEN]: [32, '00ff00'],\n  [ColorName.YELLOW]: [33, 'ffff00'],\n  [ColorName.BLUE]: [34, '0000ff'],\n  [ColorName.MAGENTA]: [35, 'ff00ff'],\n  [ColorName.CYAN]: [36, '00ffff'],\n  [ColorName.WHITE]: [37, 'ffffff'],\n  [ColorName.GRAY]: [90, '808080'],\n  [ColorName.BRIGHT_RED]: [91, 'ff5555'],\n  [ColorName.BRIGHT_GREEN]: [92, '55ff55'],\n  [ColorName.BRIGHT_YELLOW]: [93, 'ffff55'],\n  [ColorName.BRIGHT_BLUE]: [94, '5555ff'],\n  [ColorName.BRIGHT_MAGENTA]: [95, 'ff55ff'],\n  [ColorName.BRIGHT_CYAN]: [96, '55ffff'],\n  [ColorName.BRIGHT_WHITE]: [97, 'ffffff'],\n  [ColorName.BG_BLACK]: [40, '000000'],\n  [ColorName.BG_RED]: [41, 'ff0000'],\n  [ColorName.BG_GREEN]: [42, '00ff00'],\n  [ColorName.BG_YELLOW]: [43, 'ffff00'],\n  [ColorName.BG_BLUE]: [44, '0000ff'],\n  [ColorName.BG_MAGENTA]: [45, 'ff00ff'],\n  [ColorName.BG_CYAN]: [46, '00ffff'],\n  [ColorName.BG_WHITE]: [47, 'ffffff'],\n  [ColorName.BG_GRAY]: [100, '808080'],\n  [ColorName.BG_BRIGHT_RED]: [101, 'ff8888'],\n  [ColorName.BG_BRIGHT_GREEN]: [102, '88ff88'],\n  [ColorName.BG_BRIGHT_YELLOW]: [103, 'ffff88'],\n  [ColorName.BG_BRIGHT_BLUE]: [104, '8888ff'],\n  [ColorName.BG_BRIGHT_MAGENTA]: [105, 'ff88ff'],\n  [ColorName.BG_BRIGHT_CYAN]: [106, '88ffff'],\n  [ColorName.BG_BRIGHT_WHITE]: [107, 'ffffff'],\n};\n\n/**\n * Returns color codes based on the specified format\n * @param format - Output format for colors\n *   - 'ansi': Returns ANSI escape codes (e.g., '\\x1b[31m')\n *   - 'html': Returns HTML hex colors (e.g., '#ff0000')\n * @returns Object with color names as keys and color codes as values\n */\nexport function getColors(format: 'html' | 'ansi' = 'ansi'): Record<ColorName, string> {\n  const colors: Record<ColorName, string> = {} as Record<ColorName, string>;\n  for (const [name, [ansiCode, hexCode]] of Object.entries(colorMap)) {\n    colors[name] = format === 'html' ? '#' + hexCode : '\\x1b[' + ansiCode + 'm';\n  }\n  return colors;\n}\n\n/**\n * Determines the appropriate color code for a given value type\n * Used for consistent color coding in the structure visualization\n */\nfunction getColorForType(value) {\n  const colors = getColors();\n  if (typeof value === \"string\") return colors.yellow;\n  if (typeof value === \"number\") return colors.cyan;\n  if (typeof value === \"boolean\") return colors.magenta;\n  if (typeof value === \"function\") return colors.red;\n  if (value === null) return colors.gray;\n  if (Array.isArray(value)) return colors.blue;\n  if (typeof value === \"object\") return colors.green;\n  return colors.white;\n}\n\n/**\n * Returns a string representation of the value's type\n * Used to show simplified type information in the structure visualization\n */\nfunction getTypeString(value) {\n  if (typeof value === \"string\") return '\"\"';\n  if (typeof value === \"number\") return \"number\";\n  if (typeof value === \"boolean\") return \"bool\";\n  if (typeof value === \"function\") return \"function\";\n  if (value === null) return \"null\";\n  if (Array.isArray(value)) {\n    if (value.length) return \"[\" + getTypeString(value[0]) + \"]\";\n    else return \"[]\";\n  }\n  if (typeof value === \"object\") return \"{...}\";\n  return typeof value;\n}\n\n/**\n * Creates a colored visualization of a JSON object's structure\n * Shows the shape and types of the data rather than actual values\n * Recursively processes nested objects and arrays\n * @param {object} obj - The JSON object to visualize\n * @param {number} indent - The number of spaces to indent the object\n * @param {ColorFormat} colorFormat - The color format to use\n * @returns {string} The colored visualization of the JSON object\n */\nexport function printJSONStructure(obj, indent = 0, colorFormat: 'html' | 'ansi' = 'ansi') {\n  const colors = getColors(colorFormat);\n  const pad = \"  \".repeat(indent);\n  var result = \"\";\n  // Handle primitive values and null\n  if (typeof obj !== \"object\" || obj === null) {\n    const color = getColorForType(obj);\n    return color + getTypeString(obj) + colors.reset;\n  }\n  // Handle arrays with special bracket formatting\n  if (Array.isArray(obj)) {\n    result = colors.blue + \"[\" + colors.reset;\n    if (obj.length) result += \"\\n\";\n    // if array has items all of the same type or object types, print only once\n    if (obj.every((item) => typeof item === typeof obj[0])) {\n      result += pad + \"  \" + printJSONStructure(obj[0], indent + 1);\n      result += \",\";\n      result += \"\\n\";\n    } else {\n    obj.forEach((item, idx) => {\n      result += pad + \"  \" + printJSONStructure(item, indent + 1);\n      if (idx < obj.length - 1) result += \",\";\n      result += \"\\n\";\n    });\n    result += pad + colors.blue + \"]\" + colors.reset;\n    return result;\n    }\n  }\n\n  // Handle objects with special brace and property formatting\n  result = colors.green + \"{\" + colors.reset;\n  const keys = Object.keys(obj);\n  if (keys.length) result += \"\\n\";\n  keys.forEach((key, index) => {\n    const value = obj[key];\n    const color = getColorForType(value);\n    result += pad + \"  \";\n\n    // Handle nested objects recursively\n    if (typeof value === \"object\" && value !== null && !Array.isArray(value)) {\n      result +=\n        color +\n        key +\n        colors.reset +\n        \": \" +\n        printJSONStructure(value, indent + 1);\n    }\n    // Handle nested arrays recursively\n    else if (Array.isArray(value)) {\n      result +=\n        color +\n        key +\n        colors.reset +\n        \": \" +\n        printJSONStructure(value, indent + 1);\n    }\n    // Handle primitive values\n    else {\n      result += color + key + \": \" + getTypeString(value) + colors.reset;\n    }\n    if (index < keys.length - 1) result += \",\";\n    result += \"\\n\";\n  });\n  result += pad + colors.green + \"}\" + colors.reset;\n\n  // Only log at top level of recursion\n  if (indent === 0) {\n    // console.log(result);\n  }\n  return result;\n}\n\n"],"names":["ColorName","colorMap","reset","black","red","green","yellow","blue","magenta","cyan","white","gray","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite","bgBlack","bgRed","bgGreen","bgYellow","bgBlue","bgMagenta","bgCyan","bgWhite","bgGray","bgBrightRed","bgBrightGreen","bgBrightYellow","bgBrightBlue","bgBrightMagenta","bgBrightCyan","bgBrightWhite","getColors","format","colors","name","ansiCode","hexCode","Object","entries","getColorForType","value","Array","isArray","getTypeString","length","printJSONStructure","obj","indent","colorFormat","pad","repeat","result","every","item","forEach","idx","keys","key","index","color","message","options","style","hideInProduction","startSpinner","stopSpinner","window","location","hostname","includes","JSON","stringify","process","replace","match","i","global","globalThis","interval","setInterval","stdout","write","split","clearInterval","console","debug","log"],"mappings":"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"}
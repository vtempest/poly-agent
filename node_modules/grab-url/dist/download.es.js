#!/usr/bin/env node
import t from"fs";import e from"path";import{pipeline as s}from"stream/promises";import{Readable as o}from"stream";import r from"readline";import{fileURLToPath as u,pathToFileURL as i}from"url";import a from"events";const n={dots:["â ‹","â ™","â ¹","â ¸","â ¼","â ´","â ¦","â §","â ‡","â "],dots2:["â£¾","â£½","â£»","â¢¿","â¡¿","â£Ÿ","â£¯","â£·"],dots3:["â ‹","â ™","â š","â ž","â –","â ¦","â ´","â ²","â ³","â “"],dots4:["â „","â †","â ‡","â ‹","â ™","â ¸","â °","â  ","â °","â ¸","â ™","â ‹","â ‡","â †"],dots5:["â ‹","â ™","â š","â ’","â ‚","â ‚","â ’","â ²","â ´","â ¦","â –","â ’","â ","â ","â ’","â “","â ‹"],dots6:["â ","â ‰","â ™","â š","â ’","â ‚","â ‚","â ’","â ²","â ´","â ¤","â „","â „","â ¤","â ´","â ²","â ’","â ‚","â ‚","â ’","â š","â ™","â ‰","â "],dots7:["â ˆ","â ‰","â ‹","â “","â ’","â ","â ","â ’","â –","â ¦","â ¤","â  ","â  ","â ¤","â ¦","â –","â ’","â ","â ","â ’","â “","â ‹","â ‰","â ˆ"],dots8:["â ","â ","â ‰","â ™","â š","â ’","â ‚","â ‚","â ’","â ²","â ´","â ¤","â „","â „","â ¤","â  ","â  ","â ¤","â ¦","â –","â ’","â ","â ","â ’","â “","â ‹","â ‰","â ˆ","â ˆ"],dots9:["â¢¹","â¢º","â¢¼","â£¸","â£‡","â¡§","â¡—","â¡"],dots10:["â¢„","â¢‚","â¢","â¡","â¡ˆ","â¡","â¡ "],dots11:["â ","â ‚","â „","â¡€","â¢€","â  ","â ","â ˆ"],dots12:["â¢€â €","â¡€â €","â „â €","â¢‚â €","â¡‚â €","â …â €","â¢ƒâ €","â¡ƒâ €","â â €","â¢‹â €","â¡‹â €","â â ","â¢‹â ","â¡‹â ","â â ‰","â ‹â ‰","â ‹â ‰","â ‰â ™","â ‰â ™","â ‰â ©","â ˆâ¢™","â ˆâ¡™","â¢ˆâ ©","â¡€â¢™","â „â¡™","â¢‚â ©","â¡‚â¢˜","â …â¡˜","â¢ƒâ ¨","â¡ƒâ¢","â â¡","â¢‹â  ","â¡‹â¢€","â â¡","â¢‹â ","â¡‹â ","â â ‰","â ‹â ‰","â ‹â ‰","â ‰â ™","â ‰â ™","â ‰â ©","â ˆâ¢™","â ˆâ¡™","â ˆâ ©","â €â¢™","â €â¡™","â €â ©","â €â¢˜","â €â¡˜","â €â ¨","â €â¢","â €â¡","â €â  ","â €â¢€","â €â¡€"],dots13:["â£¼","â£¹","â¢»","â ¿","â¡Ÿ","â£","â£§","â£¶"],dots14:["â ‰â ‰","â ˆâ ™","â €â ¹","â €â¢¸","â €â£°","â¢€â£ ","â£€â£€","â£„â¡€","â£†â €","â¡‡â €","â â €","â ‹â "],dotsCircle:["â¢Ž ","â Žâ ","â Šâ ‘","â ˆâ ±"," â¡±","â¢€â¡°","â¢„â¡ ","â¢†â¡€"],sand:["â ","â ‚","â „","â¡€","â¡ˆ","â¡","â¡ ","â£€","â£","â£‚","â£„","â£Œ","â£”","â£¤","â£¥","â£¦","â£®","â£¶","â£·","â£¿","â¡¿","â ¿","â¢Ÿ","â Ÿ","â¡›","â ›","â «","â¢‹","â ‹","â ","â¡‰","â ‰","â ‘","â ¡","â¢"],line:["-","\\","|","/"],line2:["â ‚","-","â€“","â€”","â€“","-"],pipe:["â”¤","â”˜","â”´","â””","â”œ","â”Œ","â”¬","â”"],simpleDots:[".  ",".. ","...","   "],simpleDotsScrolling:[".  ",".. ","..."," ..","  .","   "],star:["âœ¶","âœ¸","âœ¹","âœº","âœ¹","âœ·"],star2:["+","x","*"],flip:["_","_","_","-","`","`","'","Â´","-","_","_","_"],hamburger:["â˜±","â˜²","â˜´"],growVertical:["â–","â–ƒ","â–„","â–…","â–†","â–‡","â–†","â–…","â–„","â–ƒ"],growHorizontal:["â–","â–Ž","â–","â–Œ","â–‹","â–Š","â–‰","â–Š","â–‹","â–Œ","â–","â–Ž"],balloon:[" ",".","o","O","@","*"," "],balloon2:[".","o","O","Â°","O","o","."],noise:["â–“","â–’","â–‘"],bounce:["â ","â ‚","â „","â ‚"],boxBounce:["â––","â–˜","â–","â–—"],boxBounce2:["â–Œ","â–€","â–","â–„"],triangle:["â—¢","â—£","â—¤","â—¥"],binary:["010010","001100","100101","111010","111101","010111","101011","111000","110011","110101"],arc:["â—œ","â— ","â—","â—ž","â—¡","â—Ÿ"],circle:["â—¡","âŠ™","â— "],squareCorners:["â—°","â—³","â—²","â—±"],circleQuarters:["â—´","â—·","â—¶","â—µ"],circleHalves:["â—","â—“","â—‘","â—’"],squish:["â•«","â•ª"],toggle:["âŠ¶","âŠ·"],toggle2:["â–«","â–ª"],toggle3:["â–¡","â– "],toggle4:["â– ","â–¡","â–ª","â–«"],toggle5:["â–®","â–¯"],toggle6:["á€","á€"],toggle7:["â¦¾","â¦¿"],toggle8:["â—","â—Œ"],toggle9:["â—‰","â—Ž"],toggle10:["ãŠ‚","ãŠ€","ãŠ"],toggle11:["â§‡","â§†"],toggle12:["â˜—","â˜–"],toggle13:["=","*","-"],arrow:["â†","â†–","â†‘","â†—","â†’","â†˜","â†“","â†™"],arrow2:["â¬†ï¸ ","â†—ï¸ ","âž¡ï¸ ","â†˜ï¸ ","â¬‡ï¸ ","â†™ï¸ ","â¬…ï¸ ","â†–ï¸ "],arrow3:["â–¹â–¹â–¹â–¹â–¹","â–¸â–¹â–¹â–¹â–¹","â–¹â–¸â–¹â–¹â–¹","â–¹â–¹â–¸â–¹â–¹","â–¹â–¹â–¹â–¸â–¹","â–¹â–¹â–¹â–¹â–¸"],bouncingBar:["[    ]","[=   ]","[==  ]","[=== ]","[====]","[ ===]","[  ==]","[   =]","[    ]","[   =]","[  ==]","[ ===]","[====]","[=== ]","[==  ]","[=   ]"],bouncingBall:["( â—    )","(  â—   )","(   â—  )","(    â— )","(     â—)","(    â— )","(   â—  )","(  â—   )","( â—    )","(â—     )"],smiley:["ðŸ˜„ ","ðŸ˜ "],monkey:["ðŸ™ˆ ","ðŸ™ˆ ","ðŸ™‰ ","ðŸ™Š "],hearts:["ðŸ’› ","ðŸ’™ ","ðŸ’œ ","ðŸ’š ","â¤ï¸ "],clock:["ðŸ•› ","ðŸ• ","ðŸ•‘ ","ðŸ•’ ","ðŸ•“ ","ðŸ•” ","ðŸ•• ","ðŸ•– ","ðŸ•— ","ðŸ•˜ ","ðŸ•™ ","ðŸ•š "],earth:["ðŸŒ ","ðŸŒŽ ","ðŸŒ "],moon:["ðŸŒ‘ ","ðŸŒ’ ","ðŸŒ“ ","ðŸŒ” ","ðŸŒ• ","ðŸŒ– ","ðŸŒ— ","ðŸŒ˜ "],runner:["ðŸš¶ ","ðŸƒ "],dqpb:["d","q","p","b"],weather:["â˜€ï¸ ","â˜€ï¸ ","â˜€ï¸ ","ðŸŒ¤ ","â›…ï¸ ","ðŸŒ¥ ","â˜ï¸ ","ðŸŒ§ ","ðŸŒ¨ ","ðŸŒ§ ","ðŸŒ¨ ","ðŸŒ§ ","ðŸŒ¨ ","â›ˆ ","ðŸŒ¨ ","ðŸŒ§ ","ðŸŒ¨ ","â˜ï¸ ","ðŸŒ¥ ","â›…ï¸ ","ðŸŒ¤ ","â˜€ï¸ ","â˜€ï¸ "],christmas:["ðŸŒ²","ðŸŽ„"],grenade:["ØŒ  ","â€²  "," Â´ "," â€¾ ","  â¸Œ","  â¸Š","  |","  âŽ","  â•"," à·´ ","  â“","   ","   ","   "],point:["âˆ™âˆ™âˆ™","â—âˆ™âˆ™","âˆ™â—âˆ™","âˆ™âˆ™â—","âˆ™âˆ™âˆ™"],layer:["-","=","â‰¡"],betaWave:["ÏÎ²Î²Î²Î²Î²Î²","Î²ÏÎ²Î²Î²Î²Î²","Î²Î²ÏÎ²Î²Î²Î²","Î²Î²Î²ÏÎ²Î²Î²","Î²Î²Î²Î²ÏÎ²Î²","Î²Î²Î²Î²Î²ÏÎ²","Î²Î²Î²Î²Î²Î²Ï"],fingerDance:["ðŸ¤˜ ","ðŸ¤Ÿ ","ðŸ–– ","âœ‹ ","ðŸ¤š ","ðŸ‘† "],mindblown:["ðŸ˜ ","ðŸ˜ ","ðŸ˜® ","ðŸ˜® ","ðŸ˜¦ ","ðŸ˜¦ ","ðŸ˜§ ","ðŸ˜§ ","ðŸ¤¯ ","ðŸ’¥ ","âœ¨ ","ã€€ ","ã€€ ","ã€€ "],speaker:["ðŸ”ˆ ","ðŸ”‰ ","ðŸ”Š ","ðŸ”‰ "],orangePulse:["ðŸ”¸ ","ðŸ”¶ ","ðŸŸ  ","ðŸŸ  ","ðŸ”¶ "],bluePulse:["ðŸ”¹ ","ðŸ”· ","ðŸ”µ ","ðŸ”µ ","ðŸ”· "],orangeBluePulse:["ðŸ”¸ ","ðŸ”¶ ","ðŸŸ  ","ðŸŸ  ","ðŸ”¶ ","ðŸ”¹ ","ðŸ”· ","ðŸ”µ ","ðŸ”µ ","ðŸ”· "],timeTravel:["ðŸ•› ","ðŸ•š ","ðŸ•™ ","ðŸ•˜ ","ðŸ•— ","ðŸ•– ","ðŸ•• ","ðŸ•” ","ðŸ•“ ","ðŸ•’ ","ðŸ•‘ ","ðŸ• "],aesthetic:["â–°â–±â–±â–±â–±â–±â–±","â–°â–°â–±â–±â–±â–±â–±","â–°â–°â–°â–±â–±â–±â–±","â–°â–°â–°â–°â–±â–±â–±","â–°â–°â–°â–°â–°â–±â–±","â–°â–°â–°â–°â–°â–°â–±","â–°â–°â–°â–°â–°â–°â–°","â–°â–±â–±â–±â–±â–±â–±"]};function D(t="",e={}){let{color:s,style:o="color:rgb(54, 165, 220); font-size: 10pt;",hideInProduction:r,startSpinner:u=!1,stopSpinner:i=!1}=e;const a=c();void 0===r&&(r="undefined"!=typeof window&&window?.location.hostname.includes("localhost")),"object"==typeof t&&(t=p(t)+"\n\n"+JSON.stringify(t,null,2)),Array.isArray(s)&&1==s.length&&(s=s[0]),s&&void 0!==typeof process&&(t.includes("%c")&&Array.isArray(s)?t=t.replace(/%c/g,(t,e)=>a[s[e]]||""):s&&"string"==typeof s&&(t=(a[s]||"")+t+a.reset));var n=0;return u?(global||globalThis).interval=setInterval(()=>{process.stdout.write((Array.isArray(s)?a[s[0]]:a[s]||"")+"\r"+"â ‹â ™â ¹â ¸â ¼â ´â ¦â §â ‡â ".split("")[n=++n%10]+" "+t+a.reset)},50):i?(clearInterval((global||globalThis).interval),process.stdout.write("\r"+(t||" ")+" ".repeat(t.length+20)+"\n")):"string"==typeof o?(1==o.split(" ").length||s?o=`color: ${s||o}; font-size: 11pt;`:o.match(/^#[0-9a-fA-F]{6}$/)&&(o=`color: ${o}; font-size: 11pt;`),r?console.debug((o?"%c":"")+(t||""),o):console.log((o?"%c":"")+(t||""),o)):"object"==typeof o&&console.log(t,...o),!0}const l={reset:[0,"000000"],black:[30,"000000"],red:[31,"ff0000"],green:[32,"00ff00"],yellow:[33,"ffff00"],blue:[34,"0000ff"],magenta:[35,"ff00ff"],cyan:[36,"00ffff"],white:[37,"ffffff"],gray:[90,"808080"],brightRed:[91,"ff5555"],brightGreen:[92,"55ff55"],brightYellow:[93,"ffff55"],brightBlue:[94,"5555ff"],brightMagenta:[95,"ff55ff"],brightCyan:[96,"55ffff"],brightWhite:[97,"ffffff"],bgBlack:[40,"000000"],bgRed:[41,"ff0000"],bgGreen:[42,"00ff00"],bgYellow:[43,"ffff00"],bgBlue:[44,"0000ff"],bgMagenta:[45,"ff00ff"],bgCyan:[46,"00ffff"],bgWhite:[47,"ffffff"],bgGray:[100,"808080"],bgBrightRed:[101,"ff8888"],bgBrightGreen:[102,"88ff88"],bgBrightYellow:[103,"ffff88"],bgBrightBlue:[104,"8888ff"],bgBrightMagenta:[105,"ff88ff"],bgBrightCyan:[106,"88ffff"],bgBrightWhite:[107,"ffffff"]};function c(t="ansi"){const e={};for(const[s,[o,r]]of Object.entries(l))e[s]="html"===t?"#"+r:"["+o+"m";return e}function h(t){const e=c();return"string"==typeof t?e.yellow:"number"==typeof t?e.cyan:"boolean"==typeof t?e.magenta:"function"==typeof t?e.red:null===t?e.gray:Array.isArray(t)?e.blue:"object"==typeof t?e.green:e.white}function d(t){return"string"==typeof t?'""':"number"==typeof t?"number":"boolean"==typeof t?"bool":"function"==typeof t?"function":null===t?"null":Array.isArray(t)?t.length?"["+d(t[0])+"]":"[]":"object"==typeof t?"{...}":typeof t}function p(t,e=0,s="ansi"){const o=c(s),r="  ".repeat(e);var u="";if("object"!=typeof t||null===t)return h(t)+d(t)+o.reset;if(Array.isArray(t)){if(u=o.blue+"["+o.reset,t.length&&(u+="\n"),!t.every(e=>typeof e==typeof t[0]))return t.forEach((s,o)=>{u+=r+"  "+p(s,e+1),o<t.length-1&&(u+=","),u+="\n"}),u+=r+o.blue+"]"+o.reset;u+=r+"  "+p(t[0],e+1),u+=",",u+="\n"}u=o.green+"{"+o.reset;const i=Object.keys(t);return i.length&&(u+="\n"),i.forEach((s,a)=>{const n=t[s],D=h(n);u+=r+"  ","object"!=typeof n||null===n||Array.isArray(n)?Array.isArray(n)?u+=D+s+o.reset+": "+p(n,e+1):u+=D+s+": "+d(n)+o.reset:u+=D+s+o.reset+": "+p(n,e+1),a<i.length-1&&(u+=","),u+="\n"}),u+=r+o.green+"}"+o.reset}async function m(t,e){var{headers:s,response:o={},method:r=(e?.post?"POST":e?.put?"PUT":e?.patch?"PATCH":"GET"),cache:u=!1,cacheForTime:i=60,timeout:a=30,baseURL:n="undefined"!=typeof process&&process.env.SERVER_API_URL||"/api/",cancelOngoingIfNew:l=!1,cancelNewIfOngoing:c=!1,rateLimit:h=0,debug:d=!1,infiniteScroll:C=null,setDefaults:F=!1,retryAttempts:E=0,logger:b=D,onRequest:y=null,onResponse:B=null,onError:w=null,onStream:A=null,repeatEvery:T=null,repeat:S=0,debounce:v=0,regrabOnStale:O=!1,regrabOnFocus:L=!1,regrabOnNetwork:x=!1,post:R=!1,put:P=!1,patch:M=!1,body:k=null,...$}={..."undefined"!=typeof window?window?.grab?.defaults:globalThis?.grab?.defaults||{},...e};let z=e=>t.startsWith(e);z("http:")||z("https:")?n="":z("/")||n.endsWith("/")?z("/")&&n.endsWith("/")&&(t=t.slice(1)):t="/"+t;try{if(v>0)return await f(async()=>{await m(t,{...e,debounce:0})},1e3*v);if(S>1){for(let s=0;s<S;s++)await m(t,{...e,repeat:0});return o}if(T)return setInterval(async()=>{await m(t,{...e,repeat:0,repeatEvery:null})},1e3*T),o;if(e?.setDefaults)return void("undefined"!=typeof window?window.grab.defaults={...e,setDefaults:void 0}:void 0!==globalThis.grab&&(globalThis.grab.defaults={...e,setDefaults:void 0}));if("undefined"!=typeof window){const s=async()=>await m(t,{...e,cache:!1});O&&u&&setTimeout(s,1e3*i),x&&window.addEventListener("online",s),L&&(window.addEventListener("focus",s),document.addEventListener("visibilitychange",async()=>{"visible"===document.visibilityState&&await s()}))}let g="function"==typeof o?o:null;o&&!g||(o={});var[I,_,N]=C||[];if(C?.length&&void 0!==N&&"undefined"!=typeof window){let s="string"==typeof N?document.querySelector(N):N;s?window.scrollListener&&void 0!==s&&"function"==typeof s.removeEventListener&&s.removeEventListener("scroll",window.scrollListener):D("paginateDOM not found",{color:"red"}),window.scrollListener=async s=>{const o=s.target;localStorage.setItem("scroll",JSON.stringify([o.scrollTop,o.scrollLeft,N])),o.scrollHeight-o.scrollTop<=o.clientHeight+200&&await m(t,{...e,cache:!1,[I]:E?.currentPage+1})},s&&s.addEventListener("scroll",window.scrollListener)}let F=JSON.stringify(I?{...$,[I]:void 0}:$),E=m?.log?.find(e=>e.request==F&&e.path==t);if(I){let t=E?.currentPage+1||$?.[I]||1;E||(o[_]=[],t=1),E&&(E.currentPage=t),$={...$,[I]:t}}else{for(let t of Object.keys(o))o[t]=void 0;if(u&&(!i||E?.lastFetchTime>Date.now()-1e3*i)){for(let t of Object.keys(E.res))o[t]=E.res[t];g&&(o=g(o))}}if(g?g({isLoading:!0}):"object"==typeof o&&(o.isLoading=!0),g&&(o=g(o)),h>0&&E?.lastFetchTime&&E.lastFetchTime>Date.now()-1e3*h)throw new Error(`Fetch rate limit exceeded for ${t}. \n        Wait ${h}s between requests.`);if(E?.controller)if(l)E.controller.abort();else if(c)return{isLoading:!0};void 0!==m.log&&m.log?.unshift({path:t,request:F,lastFetchTime:Date.now(),controller:new AbortController});let w={method:r,headers:{"Content-Type":"application/json",Accept:"application/json",...s},body:$.body,redirect:"follow",cache:u?"force-cache":"no-store",signal:l?m.log[0]?.controller?.signal:AbortSignal.timeout(1e3*a)},R="";["POST","PUT","PATCH"].includes(r)?w.body=$.body||JSON.stringify($):R=(Object.keys($).length?"?":"")+new URLSearchParams($).toString(),"function"==typeof y&&([t,o,$,w]=y(t,o,$,w));let P=null,M=/* @__PURE__ */new Date,k=m.mock?.[t],z=t=>new Promise(e=>setTimeout(e,1e3*t||0));if(!k||k.params&&k.method!=r||k.params&&F!=JSON.stringify(k.params)){if(P=await fetch(n+t+R,w).catch(t=>{throw new Error(t.message)}),!P.ok)throw new Error(`HTTP error: ${P.status} ${P.statusText}`);let e=P.headers.get("content-type");A?await A(P.body):P=await(e?e.includes("application/json")?P&&P.json():e.includes("application/pdf")||e.includes("application/octet-stream")?P.blob():P.text():P.json()).catch(t=>{throw new Error("Error parsing response: "+t)})}else await z(k.delay),P="function"==typeof k.response?k.response($):k.response;"function"==typeof B&&([t,o,$,w]=B(t,o,$,w)),g?g({isLoading:void 0}):"object"==typeof o&&delete o?.isLoading,delete E?.controller;const j=((Number(/* @__PURE__ */new Date)-Number(M))/1e3).toFixed(1);if(d&&b("Path:"+n+t+R+"\n"+JSON.stringify(e,null,2)+"\nTime: "+j+"s\nResponse: "+p(P)),"object"==typeof P){for(let t of Object.keys(P))o[t]=_==t&&o[t]?.length?[...o[t],...P[t]]:P[t];void 0!==o&&(o.data=P)}else g?g({data:P,...P}):"object"==typeof o&&(o.data=P);return void 0!==m.log&&m.log?.unshift({path:t,request:JSON.stringify({...$,paginateKey:void 0}),response:o,lastFetchTime:Date.now()}),g&&(o=g(o)),o}catch(j){let s="Error: "+j.message+"\nPath:"+n+t+"\n";return"function"==typeof w&&w(j.message,n+t,$),e.retryAttempts>0?await m(t,{...e,retryAttempts:--e.retryAttempts}):(!j.message.includes("signal")&&e.debug&&(b(s,{color:"red"}),d&&"undefined"!=typeof document&&g(s)),o.error=j.message,"function"==typeof o?(o.data=o({isLoading:void 0,error:j.message}),o=o.data):delete o?.isLoading,void 0!==m.log&&m.log?.unshift({path:t,request:JSON.stringify($),error:j.message}),o)}}m.instance=(t={})=>(e,s={})=>m(e,{...t,...s});const f=async(t,e)=>{let s;return async function(...o){clearTimeout(s),s=setTimeout(async()=>{clearTimeout(s),await t(...o)},e)}};function g(t){if("undefined"==typeof document)return;let e,s=document.getElementById("alert-overlay");s||(s=document.body.appendChild(document.createElement("div")),s.id="alert-overlay",s.setAttribute("style","position:fixed;inset:0;z-index:9999;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center"),s.innerHTML='<div id="alert-box" style="background:#fff;padding:1.5em 2em;border-radius:8px;box-shadow:0 2px 16px #0003;min-width:220px;max-height:80vh;position:relative;display:flex;flex-direction:column;">\n      <button id="close-alert" style="position:absolute;top:12px;right:20px;font-size:1.5em;background:none;border:none;cursor:pointer;color:black;">&times;</button>\n      <div id="alert-list" style="overflow:auto;flex:1;"></div>\n    </div>',s.addEventListener("click",t=>t.target==s&&s.remove()),document.getElementById("close-alert").onclick=()=>s.remove()),e=s.querySelector("#alert-list"),e.innerHTML+=`<div style="border-bottom:1px solid #333; font-size:1.2em;margin:0.5em 0;">${t}</div>`}function C(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var F,E,b,y;function B(){if(y)return b;y=1;const t=r;return b=class{constructor(t){this.stream=t,this.linewrap=!0,this.dy=0}cursorSave(){this.stream.isTTY&&this.stream.write("7")}cursorRestore(){this.stream.isTTY&&this.stream.write("8")}cursor(t){this.stream.isTTY&&(t?this.stream.write("[?25h"):this.stream.write("[?25l"))}cursorTo(e=null,s=null){this.stream.isTTY&&t.cursorTo(this.stream,e,s)}cursorRelative(e=null,s=null){this.stream.isTTY&&(this.dy=this.dy+s,t.moveCursor(this.stream,e,s))}cursorRelativeReset(){this.stream.isTTY&&(t.moveCursor(this.stream,0,-this.dy),t.cursorTo(this.stream,0,null),this.dy=0)}clearRight(){this.stream.isTTY&&t.clearLine(this.stream,1)}clearLine(){this.stream.isTTY&&t.clearLine(this.stream,0)}clearBottom(){this.stream.isTTY&&t.clearScreenDown(this.stream)}newline(){this.stream.write("\n"),this.dy++}write(t,e=!1){!0===this.linewrap&&!1===e?this.stream.write(t.substr(0,this.getWidth())):this.stream.write(t)}lineWrapping(t){this.stream.isTTY&&(this.linewrap=t,t?this.stream.write("[?7h"):this.stream.write("[?7l"))}isTTY(){return!0===this.stream.isTTY}getWidth(){return this.stream.columns||(this.stream.isTTY?80:200)}}}"undefined"!=typeof window?(window.log=D,window.grab=m,window.grab.log=[],window.grab.mock={},window.grab.defaults={},document.addEventListener("keydown",t=>{if("i"===t.key&&t.ctrlKey&&t.altKey){let t=" ";for(let e of m.log)t+=`<div style="margin-bottom:1em; border-bottom:1px solid #ccc; padding-bottom:1em;">\n          <b>Path:</b> ${e.path}<br>\n          <b>Request:</b> ${p(e.request,0,"html")}<br>\n          <b>Response:</b> ${p(e.response,0,"html")}<br> \n          <b>Time:</b> ${new Date(e.lastFetchTime).toLocaleString()}\n        </div>`;g(t)}}),document.addEventListener("DOMContentLoaded",()=>{let[t,e,s]=JSON.parse(localStorage.getItem("scroll"))||[];t&&(document.querySelector(s).scrollTop=t,document.querySelector(s).scrollLeft=e)})):"undefined"!=typeof globalThis&&(m.log=[],m.mock={},m.defaults={},globalThis.log=D,globalThis.grab=m.instance());var w,A,T,S,v={exports:{}};function O(){if(S)return T;S=1;const t=A?w:(A=1,w=({onlyFirst:t=!1}={})=>{const e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,t?void 0:"g")});return T=e=>"string"==typeof e?e.replace(t(),""):e}var L,x,R,P,M,k,$,z,I,_,N,j,U,G,W,Y,q,H,J,V,K,Z,Q,X,tt,et,st,ot,rt,ut,it,at,nt={exports:{}};function Dt(){if(P)return v.exports;P=1;const t=O(),e=function(){if(L)return nt.exports;L=1;const t=t=>!Number.isNaN(t)&&t>=4352&&(t<=4447||9001===t||9002===t||11904<=t&&t<=12871&&12351!==t||12880<=t&&t<=19903||19968<=t&&t<=42182||43360<=t&&t<=43388||44032<=t&&t<=55203||63744<=t&&t<=64255||65040<=t&&t<=65049||65072<=t&&t<=65131||65281<=t&&t<=65376||65504<=t&&t<=65510||110592<=t&&t<=110593||127488<=t&&t<=127569||131072<=t&&t<=262141);return nt.exports=t,nt.exports.default=t,nt.exports}(),s=R?x:(R=1,x=function(){return/\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F|\uD83D\uDC68(?:\uD83C\uDFFC\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68\uD83C\uDFFB|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFE])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFE\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83D\uDC68|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|[\u2695\u2696\u2708]\uFE0F|\uD83D[\uDC66\uDC67]|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83C\uDFFB\u200D[\u2695\u2696\u2708]|\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708])\uFE0F|\uD83C\uDFFB\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C[\uDFFB-\uDFFF])|(?:\uD83E\uDDD1\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D\uD83D\uDC69)\uD83C\uDFFB|\uD83E\uDDD1(?:\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1)|(?:\uD83E\uDDD1\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFB-\uDFFE])|(?:\uD83E\uDDD1\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D\uD83D\uDC69)(?:\uD83C[\uDFFB\uDFFC])|\uD83D\uDC69(?:\uD83C\uDFFE\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFC\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFB\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFC-\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD]))|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83E\uDDD1\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D\uD83D\uDC69)(?:\uD83C[\uDFFB-\uDFFD])|\uD83D\uDC69\u200D\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83D\uDC69(?:\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708]|\uD83C\uDFFB\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])|(?:(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)\uFE0F|\uD83D\uDC6F|\uD83E[\uDD3C\uDDDE\uDDDF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDD])(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|\u200D[\u2640\u2642])|\uD83C\uDFF4\u200D\u2620)\uFE0F|\uD83D\uDC69\u200D\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|\uD83D\uDC15\u200D\uD83E\uDDBA|\uD83D\uDC69\u200D\uD83D\uDC66|\uD83D\uDC69\u200D\uD83D\uDC67|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDF6\uD83C\uDDE6|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD36\uDDB5\uDDB6\uDDBB\uDDD2-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDED5\uDEEB\uDEEC\uDEF4-\uDEFA\uDFE0-\uDFEB]|\uD83E[\uDD0D-\uDD3A\uDD3C-\uDD45\uDD47-\uDD71\uDD73-\uDD76\uDD7A-\uDDA2\uDDA5-\uDDAA\uDDAE-\uDDCA\uDDCD-\uDDFF\uDE70-\uDE73\uDE78-\uDE7A\uDE80-\uDE82\uDE90-\uDE95])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFA\uDFE0-\uDFEB]|\uD83E[\uDD0D-\uDD3A\uDD3C-\uDD45\uDD47-\uDD71\uDD73-\uDD76\uDD7A-\uDDA2\uDDA5-\uDDAA\uDDAE-\uDDCA\uDDCD-\uDDFF\uDE70-\uDE73\uDE78-\uDE7A\uDE80-\uDE82\uDE90-\uDE95])\uFE0F|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDC8F\uDC91\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0F\uDD18-\uDD1F\uDD26\uDD30-\uDD39\uDD3C-\uDD3E\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD])/g}),o=o=>{if("string"!=typeof o||0===o.length)return 0;if(0===(o=t(o)).length)return 0;o=o.replace(s(),"  ");let r=0;for(let t=0;t<o.length;t++){const s=o.codePointAt(t);s<=31||s>=127&&s<=159||(s>=768&&s<=879||(s>65535&&t++,r+=e(s)?2:1))}return r};return v.exports=o,v.exports.default=o,v.exports}function lt(){return k?M:(k=1,M=function(t,e,s){if(!0!==e.autopadding)return t;return"percentage"===s?(o=t,(e.autopaddingChar+o).slice(-3)):t;var o})}function ct(){return z?$:(z=1,$=function(t,e){const s=Math.round(t*e.barsize),o=e.barsize-s;return e.barCompleteString.substr(0,s)+e.barGlue+e.barIncompleteString.substr(0,o)})}function ht(){return _?I:(_=1,I=function(t,e,s){function o(t){return s?s*Math.round(t/s):t}function r(t){return(e.autopaddingChar+t).slice(-2)}return t>3600?r(Math.floor(t/3600))+"h"+r(o(t%3600/60))+"m":t>60?r(Math.floor(t/60))+"m"+r(o(t%60))+"s":t>10?r(o(t))+"s":r(t)+"s"})}function dt(){if(j)return N;j=1;const t=Dt(),e=lt(),s=ct(),o=ht();return N=function(r,u,i){let a=r.format;const n=r.formatTime||o,D=r.formatValue||e,l=r.formatBar||s,c=Math.floor(100*u.progress)+"",h=u.stopTime||Date.now(),d=Math.round((h-u.startTime)/1e3),p=Object.assign({},i,{bar:l(u.progress,r),percentage:D(c,r,"percentage"),total:D(u.total,r,"total"),value:D(u.value,r,"value"),eta:D(u.eta,r,"eta"),eta_formatted:n(u.eta,r,5),duration:D(d,r,"duration"),duration_formatted:n(d,r,1)});a=a.replace(/\{(\w+)\}/g,function(t,e){return void 0!==p[e]?p[e]:t});const m=Math.max(0,u.maxWidth-t(a)-2),f=Math.floor(m/2);switch(r.align){case"right":a=m>0?" ".repeat(m)+a:a;break;case"center":a=f>0?" ".repeat(f)+a:a}return a}}function pt(){if(G)return U;function t(t,e){return null==t?e:t}return G=1,U={parse:function(e,s){const o={},r=Object.assign({},s,e);return o.throttleTime=1e3/t(r.fps,10),o.stream=t(r.stream,process.stderr),o.terminal=t(r.terminal,null),o.clearOnComplete=t(r.clearOnComplete,!1),o.stopOnComplete=t(r.stopOnComplete,!1),o.barsize=t(r.barsize,40),o.align=t(r.align,"left"),o.hideCursor=t(r.hideCursor,!1),o.linewrap=t(r.linewrap,!1),o.barGlue=t(r.barGlue,""),o.barCompleteChar=t(r.barCompleteChar,"="),o.barIncompleteChar=t(r.barIncompleteChar,"-"),o.format=t(r.format,"progress [{bar}] {percentage}% | ETA: {eta}s | {value}/{total}"),o.formatTime=t(r.formatTime,null),o.formatValue=t(r.formatValue,null),o.formatBar=t(r.formatBar,null),o.etaBufferLength=t(r.etaBuffer,10),o.etaAsynchronousUpdate=t(r.etaAsynchronousUpdate,!1),o.progressCalculationRelative=t(r.progressCalculationRelative,!1),o.synchronousUpdate=t(r.synchronousUpdate,!0),o.noTTYOutput=t(r.noTTYOutput,!1),o.notTTYSchedule=t(r.notTTYSchedule,2e3),o.emptyOnZero=t(r.emptyOnZero,!1),o.forceRedraw=t(r.forceRedraw,!1),o.autopadding=t(r.autopadding,!1),o.gracefulExit=t(r.gracefulExit,!1),o},assignDerivedOptions:function(e){return e.barCompleteString=e.barCompleteChar.repeat(e.barsize+1),e.barIncompleteString=e.barIncompleteChar.repeat(e.barsize+1),e.autopaddingChar=e.autopadding?t(e.autopaddingChar,"   "):"",e}}}function mt(){if(Y)return W;Y=1;const t=E?F:(E=1,F=class{constructor(t,e,s){this.etaBufferLength=t||100,this.valueBuffer=[s],this.timeBuffer=[e],this.eta="0"}update(t,e,s){this.valueBuffer.push(e),this.timeBuffer.push(t),this.calculate(s-e)}getTime(){return this.eta}calculate(t){const e=this.valueBuffer.length,s=Math.min(this.etaBufferLength,e),o=(this.valueBuffer[e-1]-this.valueBuffer[e-s])/(this.timeBuffer[e-1]-this.timeBuffer[e-s]);this.valueBuffer=this.valueBuffer.slice(-this.etaBufferLength),this.timeBuffer=this.timeBuffer.slice(-this.etaBufferLength);const r=Math.ceil(t/o/1e3);isNaN(r)?this.eta="NULL":isFinite(r)?this.eta=r>1e7?"INF":r<0?0:r:this.eta="INF"}}),e=B(),s=dt(),o=pt(),r=a;return W=class extends r{constructor(r){super(),this.options=o.assignDerivedOptions(r),this.terminal=this.options.terminal?this.options.terminal:new e(this.options.stream),this.value=0,this.startValue=0,this.total=100,this.lastDrawnString=null,this.startTime=null,this.stopTime=null,this.lastRedraw=Date.now(),this.eta=new t(this.options.etaBufferLength,0,0),this.payload={},this.isActive=!1,this.formatter="function"==typeof this.options.format?this.options.format:s}render(t=!1){const e={progress:this.getProgress(),eta:this.eta.getTime(),startTime:this.startTime,stopTime:this.stopTime,total:this.total,value:this.value,maxWidth:this.terminal.getWidth()};this.options.etaAsynchronousUpdate&&this.updateETA();const s=this.formatter(this.options,e,this.payload);(t||this.options.forceRedraw||this.options.noTTYOutput&&!this.terminal.isTTY()||this.lastDrawnString!=s)&&(this.emit("redraw-pre"),this.terminal.cursorTo(0,null),this.terminal.write(s),this.terminal.clearRight(),this.lastDrawnString=s,this.lastRedraw=Date.now(),this.emit("redraw-post"))}start(e,s,o){this.value=s||0,this.total=void 0!==e&&e>=0?e:100,this.startValue=s||0,this.payload=o||{},this.startTime=Date.now(),this.stopTime=null,this.lastDrawnString="",this.eta=new t(this.options.etaBufferLength,this.startTime,this.value),this.isActive=!0,this.emit("start",e,s)}stop(){this.isActive=!1,this.stopTime=Date.now(),this.emit("stop",this.total,this.value)}update(t,e={}){"number"==typeof t&&(this.value=t,this.eta.update(Date.now(),t,this.total));const s=("object"==typeof t?t:e)||{};this.emit("update",this.total,this.value);for(const o in s)this.payload[o]=s[o];this.value>=this.getTotal()&&this.options.stopOnComplete&&this.stop()}getProgress(){let t=this.value/this.total;return this.options.progressCalculationRelative&&(t=(this.value-this.startValue)/(this.total-this.startValue)),isNaN(t)&&(t=this.options&&this.options.emptyOnZero?0:1),t=Math.min(Math.max(t,0),1),t}increment(t=1,e={}){"object"==typeof t?this.update(this.value+1,t):this.update(this.value+t,e)}getTotal(){return this.total}setTotal(t){void 0!==t&&t>=0&&(this.total=t)}updateETA(){this.eta.update(Date.now(),this.value,this.total)}}}function ft(){if(ut)return rt;ut=1;const t=Z?K:(Z=1,K={format:"progress [{bar}] {percentage}% | ETA: {eta}s | {value}/{total}",barCompleteChar:"=",barIncompleteChar:"-"}),e=X?Q:(X=1,Q={format:" {bar} {percentage}% | ETA: {eta}s | {value}/{total}",barCompleteChar:"â–ˆ",barIncompleteChar:"â–‘"}),s=et?tt:(et=1,tt={format:" [90m{bar}[0m {percentage}% | ETA: {eta}s | {value}/{total}",barCompleteChar:"â–ˆ",barIncompleteChar:"â–‘"}),o=ot?st:(ot=1,st={format:" {bar}â–  {percentage}% | ETA: {eta}s | {value}/{total}",barCompleteChar:"â– ",barIncompleteChar:" "});return rt={legacy:t,shades_classic:e,shades_grey:s,rect:o}}const gt=/* @__PURE__ */C(function(){if(at)return it;at=1;const t=function(){if(H)return q;H=1;const t=mt(),e=pt();return q=class extends t{constructor(t,s){super(e.parse(t,s)),this.timer=null,this.options.noTTYOutput&&!1===this.terminal.isTTY()&&(this.options.synchronousUpdate=!1),this.schedulingRate=this.terminal.isTTY()?this.options.throttleTime:this.options.notTTYSchedule,this.sigintCallback=null}render(){this.timer&&(clearTimeout(this.timer),this.timer=null),super.render(),this.options.noTTYOutput&&!1===this.terminal.isTTY()&&this.terminal.newline(),this.timer=setTimeout(this.render.bind(this),this.schedulingRate)}update(t,e){this.timer&&(super.update(t,e),this.options.synchronousUpdate&&this.lastRedraw+2*this.options.throttleTime<Date.now()&&this.render())}start(t,e,s){!1===this.options.noTTYOutput&&!1===this.terminal.isTTY()||(null===this.sigintCallback&&this.options.gracefulExit&&(this.sigintCallback=this.stop.bind(this),process.once("SIGINT",this.sigintCallback),process.once("SIGTERM",this.sigintCallback)),this.terminal.cursorSave(),!0===this.options.hideCursor&&this.terminal.cursor(!1),!1===this.options.linewrap&&this.terminal.lineWrapping(!1),super.start(t,e,s),this.render())}stop(){this.timer&&(this.sigintCallback&&(process.removeListener("SIGINT",this.sigintCallback),process.removeListener("SIGTERM",this.sigintCallback),this.sigintCallback=null),this.render(),super.stop(),clearTimeout(this.timer),this.timer=null,!0===this.options.hideCursor&&this.terminal.cursor(!0),!1===this.options.linewrap&&this.terminal.lineWrapping(!0),this.terminal.cursorRestore(),this.options.clearOnComplete?(this.terminal.cursorTo(0,null),this.terminal.clearLine()):this.terminal.newline())}}}(),e=function(){if(V)return J;V=1;const t=B(),e=mt(),s=pt(),o=a;return J=class extends o{constructor(e,o){super(),this.bars=[],this.options=s.parse(e,o),this.options.synchronousUpdate=!1,this.terminal=this.options.terminal?this.options.terminal:new t(this.options.stream),this.timer=null,this.isActive=!1,this.schedulingRate=this.terminal.isTTY()?this.options.throttleTime:this.options.notTTYSchedule,this.loggingBuffer=[],this.sigintCallback=null}create(t,s,o,r={}){const u=new e(Object.assign({},this.options,{terminal:this.terminal},r));return this.bars.push(u),!1===this.options.noTTYOutput&&!1===this.terminal.isTTY()||(null===this.sigintCallback&&this.options.gracefulExit&&(this.sigintCallback=this.stop.bind(this),process.once("SIGINT",this.sigintCallback),process.once("SIGTERM",this.sigintCallback)),this.isActive||(!0===this.options.hideCursor&&this.terminal.cursor(!1),!1===this.options.linewrap&&this.terminal.lineWrapping(!1),this.timer=setTimeout(this.update.bind(this),this.schedulingRate)),this.isActive=!0,u.start(t,s,o),this.emit("start")),u}remove(t){const e=this.bars.indexOf(t);return!(e<0||(this.bars.splice(e,1),this.update(),this.terminal.newline(),this.terminal.clearBottom(),0))}update(){if(this.timer&&(clearTimeout(this.timer),this.timer=null),this.emit("update-pre"),this.terminal.cursorRelativeReset(),this.emit("redraw-pre"),this.loggingBuffer.length>0)for(this.terminal.clearLine();this.loggingBuffer.length>0;)this.terminal.write(this.loggingBuffer.shift(),!0);for(let t=0;t<this.bars.length;t++)t>0&&this.terminal.newline(),this.bars[t].render();this.emit("redraw-post"),this.options.noTTYOutput&&!1===this.terminal.isTTY()&&(this.terminal.newline(),this.terminal.newline()),this.timer=setTimeout(this.update.bind(this),this.schedulingRate),this.emit("update-post"),this.options.stopOnComplete&&!this.bars.find(t=>t.isActive)&&this.stop()}stop(){if(clearTimeout(this.timer),this.timer=null,this.sigintCallback&&(process.removeListener("SIGINT",this.sigintCallback),process.removeListener("SIGTERM",this.sigintCallback),this.sigintCallback=null),this.isActive=!1,!0===this.options.hideCursor&&this.terminal.cursor(!0),!1===this.options.linewrap&&this.terminal.lineWrapping(!0),this.terminal.cursorRelativeReset(),this.emit("stop-pre-clear"),this.options.clearOnComplete)this.terminal.clearBottom();else{for(let t=0;t<this.bars.length;t++)t>0&&this.terminal.newline(),this.bars[t].render(),this.bars[t].stop();this.terminal.newline()}this.emit("stop")}log(t){this.loggingBuffer.push(t)}}}(),s=ft(),o=dt(),r=lt(),u=ct(),i=ht();return it={Bar:t,SingleBar:t,MultiBar:e,Presets:s,Format:{Formatter:o,BarFormat:u,ValueFormat:r,TimeFormat:i}}}()),Ct=(t=0)=>e=>`[${e+t}m`,Ft=(t=0)=>e=>`[${38+t};5;${e}m`,Et=(t=0)=>(e,s,o)=>`[${38+t};2;${e};${s};${o}m`,bt={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};Object.keys(bt.modifier);Object.keys(bt.color),Object.keys(bt.bgColor);const yt=function(){const t=/* @__PURE__ */new Map;for(const[e,s]of Object.entries(bt)){for(const[e,o]of Object.entries(s))bt[e]={open:`[${o[0]}m`,close:`[${o[1]}m`},s[e]=bt[e],t.set(o[0],o[1]);Object.defineProperty(bt,e,{value:s,enumerable:!1})}return Object.defineProperty(bt,"codes",{value:t,enumerable:!1}),bt.color.close="[39m",bt.bgColor.close="[49m",bt.color.ansi=Ct(),bt.color.ansi256=Ft(),bt.color.ansi16m=Et(),bt.bgColor.ansi=Ct(10),bt.bgColor.ansi256=Ft(10),bt.bgColor.ansi16m=Et(10),Object.defineProperties(bt,{rgbToAnsi256:{value:(t,e,s)=>t===e&&e===s?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(e/255*5)+Math.round(s/255*5),enumerable:!1},hexToRgb:{value(t){const e=/[a-f\d]{6}|[a-f\d]{3}/i.exec(t.toString(16));if(!e)return[0,0,0];let[s]=e;3===s.length&&(s=[...s].map(t=>t+t).join(""));const o=Number.parseInt(s,16);return[o>>16&255,o>>8&255,255&o]},enumerable:!1},hexToAnsi256:{value:t=>bt.rgbToAnsi256(...bt.hexToRgb(t)),enumerable:!1},ansi256ToAnsi:{value(t){if(t<8)return 30+t;if(t<16)return t-8+90;let e,s,o;if(t>=232)e=(10*(t-232)+8)/255,s=e,o=e;else{const r=(t-=16)%36;e=Math.floor(t/36)/5,s=Math.floor(r/6)/5,o=r%6/5}const r=2*Math.max(e,s,o);if(0===r)return 30;let u=30+(Math.round(o)<<2|Math.round(s)<<1|Math.round(e));return 2===r&&(u+=60),u},enumerable:!1},rgbToAnsi:{value:(t,e,s)=>bt.ansi256ToAnsi(bt.rgbToAnsi256(t,e,s)),enumerable:!1},hexToAnsi:{value:t=>bt.ansi256ToAnsi(bt.hexToAnsi256(t)),enumerable:!1}}),bt}(),Bt=(()=>{if(!("navigator"in globalThis))return 0;if(globalThis.navigator.userAgentData){const t=navigator.userAgentData.brands.find(({brand:t})=>"Chromium"===t);if(t&&t.version>93)return 3}return/\b(Chrome|Chromium)\//.test(globalThis.navigator.userAgent)?1:0})(),wt=0!==Bt&&{level:Bt},At={stdout:wt,stderr:wt};function Tt(t,e,s){let o=t.indexOf(e);if(-1===o)return t;const r=e.length;let u=0,i="";do{i+=t.slice(u,o)+e+s,u=o+r,o=t.indexOf(e,u)}while(-1!==o);return i+=t.slice(u),i}const{stdout:St,stderr:vt}=At,Ot=/* @__PURE__ */Symbol("GENERATOR"),Lt=/* @__PURE__ */Symbol("STYLER"),xt=/* @__PURE__ */Symbol("IS_EMPTY"),Rt=["ansi","ansi","ansi256","ansi16m"],Pt=/* @__PURE__ */Object.create(null),Mt=t=>{const e=(...t)=>t.join(" ");return((t,e={})=>{if(e.level&&!(Number.isInteger(e.level)&&e.level>=0&&e.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");const s=St?St.level:0;t.level=void 0===e.level?s:e.level})(e,t),Object.setPrototypeOf(e,kt.prototype),e};function kt(t){return Mt(t)}Object.setPrototypeOf(kt.prototype,Function.prototype);for(const[Yt,qt]of Object.entries(yt))Pt[Yt]={get(){const t=Nt(this,_t(qt.open,qt.close,this[Lt]),this[xt]);return Object.defineProperty(this,Yt,{value:t}),t}};Pt.visible={get(){const t=Nt(this,this[Lt],!0);return Object.defineProperty(this,"visible",{value:t}),t}};const $t=(t,e,s,...o)=>"rgb"===t?"ansi16m"===e?yt[s].ansi16m(...o):"ansi256"===e?yt[s].ansi256(yt.rgbToAnsi256(...o)):yt[s].ansi(yt.rgbToAnsi(...o)):"hex"===t?$t("rgb",e,s,...yt.hexToRgb(...o)):yt[s][t](...o),zt=["rgb","hex","ansi256"];for(const Yt of zt){Pt[Yt]={get(){const{level:t}=this;return function(...e){const s=_t($t(Yt,Rt[t],"color",...e),yt.color.close,this[Lt]);return Nt(this,s,this[xt])}}};Pt["bg"+Yt[0].toUpperCase()+Yt.slice(1)]={get(){const{level:t}=this;return function(...e){const s=_t($t(Yt,Rt[t],"bgColor",...e),yt.bgColor.close,this[Lt]);return Nt(this,s,this[xt])}}}}const It=Object.defineProperties(()=>{},{...Pt,level:{enumerable:!0,get(){return this[Ot].level},set(t){this[Ot].level=t}}}),_t=(t,e,s)=>{let o,r;return void 0===s?(o=t,r=e):(o=s.openAll+t,r=e+s.closeAll),{open:t,close:e,openAll:o,closeAll:r,parent:s}},Nt=(t,e,s)=>{const o=(...t)=>jt(o,1===t.length?""+t[0]:t.join(" "));return Object.setPrototypeOf(o,It),o[Ot]=t,o[Lt]=e,o[xt]=s,o},jt=(t,e)=>{if(t.level<=0||!e)return t[xt]?"":e;let s=t[Lt];if(void 0===s)return e;const{openAll:o,closeAll:r}=s;if(e.includes(""))for(;void 0!==s;)e=Tt(e,s.close,s.open),s=s.parent;const u=e.indexOf("\n");return-1!==u&&(e=function(t,e,s,o){let r=0,u="";do{const i="\r"===t[o-1];u+=t.slice(r,i?o-1:o)+e+(i?"\r\n":"\n")+s,r=o+1,o=t.indexOf("\n",r)}while(-1!==o);return u+=t.slice(r),u}(e,r,o,u)),o+e+r};Object.defineProperties(kt.prototype,Pt);const Ut=kt();kt({level:vt?vt.level:0}),e.dirname(u(import.meta.url));class Gt{constructor(){this.commands={},this.options={},this.examples=[],this.helpText="",this.versionText="1.0.0"}usage(t){return this.helpText=t,this}command(t,e,s){const o=t.match(/\$0 <(\w+)>/);return o&&(this.commands[o[1]]={desc:e,handler:s,required:!0}),this}option(t,e={}){return this.options[t]=e,this}example(t,e){return this.examples.push({cmd:t,desc:e}),this}help(){return this}alias(t,e){return this.options[e]&&(this.options[e].alias=t),this}version(t){return t&&(this.versionText=t),this}strict(){return this}parseSync(){const t=process.argv.slice(2),e={},s=[];(t.includes("--help")||t.includes("-h"))&&(this.showHelp(),process.exit(0)),t.includes("--version")&&(console.log(this.versionText),process.exit(0));for(let o=0;o<t.length;o++){const r=t[o];if(r.startsWith("--")){const[s,u]=r.split("="),i=s.slice(2);if(void 0!==u)e[i]=this.coerceValue(i,u);else if("boolean"===this.options[i]?.type)e[i]=!0;else{const s=t[o+1];s&&!s.startsWith("-")?(e[i]=this.coerceValue(i,s),o++):e[i]=!0}}else if(r.startsWith("-")&&2===r.length){const s=r[1],u=this.findLongName(s);if(u)if("boolean"===this.options[u]?.type)e[u]=!0;else{const s=t[o+1];s&&!s.startsWith("-")&&(e[u]=this.coerceValue(u,s),o++)}}else s.push(r)}return s.length>0&&(e.urls=s),Object.keys(this.options).forEach(t=>{void 0===e[t]&&void 0!==this.options[t].default&&(e[t]=this.options[t].default)}),e.urls&&0!==e.urls.length||!this.commands.url?.required||(console.error("Error: Missing required argument: url"),this.showHelp(),process.exit(1)),e}coerceValue(t,e){const s=this.options[t];if(!s)return e;if(s.coerce)return s.coerce(e);switch(s.type){case"number":return Number(e);case"boolean":return"true"===e||"1"===e;default:return e}}findLongName(t){return Object.keys(this.options).find(e=>this.options[e].alias===t)}showHelp(){console.log(this.helpText||"Usage: grab <url> [options]"),console.log("\nPositional arguments:"),Object.keys(this.commands).forEach(t=>{console.log(`  ${t.padEnd(20)} ${this.commands[t].desc}`)}),console.log("\nOptions:"),Object.keys(this.options).forEach(t=>{const e=this.options[t],s=e.alias?`-${e.alias}, --${t}`:`--${t}`;console.log(`  ${s.padEnd(20)} ${e.describe||""}`)}),this.examples.length>0&&(console.log("\nExamples:"),this.examples.forEach(t=>{console.log(`  ${t.cmd}`),console.log(`    ${t.desc}`)}))}}class Wt{constructor(){this.progressBar=null,this.multiBar=null,this.loadingSpinner=null,this.abortController=null,this.COL_FILENAME=25,this.COL_SPINNER=2,this.COL_BAR=15,this.COL_PERCENT=4,this.COL_DOWNLOADED=16,this.COL_TOTAL=10,this.COL_SPEED=10,this.COL_ETA=10,this.colors={primary:Ut.cyan,success:Ut.green,warning:Ut.yellow,error:Ut.red,info:Ut.blue,purple:Ut.magenta,pink:Ut.magentaBright,yellow:Ut.yellowBright,cyan:Ut.cyanBright,green:Ut.green,gradient:[Ut.blue,Ut.magenta,Ut.cyan,Ut.green,Ut.yellow,Ut.red]},this.barColors=["[32m","[33m","[34m","[35m","[36m","[91m","[92m","[93m","[94m","[95m","[96m"],this.barGlueColors=["[31m","[33m","[35m","[37m","[90m","[93m","[97m"],this.spinnerTypes=Object.keys(n.default||n),this.stateDir=this.getStateDirectory(),this.ensureStateDirectoryExists(),this.isPaused=!1,this.pauseCallback=null,this.resumeCallback=null,this.abortControllers=[],this.keyboardListener=null,this.isAddingUrl=!1}getStateDirectory(){return process.env.GRAB_DOWNLOAD_STATE_DIR||e.join(process.cwd(),".grab-downloads")}ensureStateDirectoryExists(){try{t.existsSync(this.stateDir)||t.mkdirSync(this.stateDir,{recursive:!0})}catch(e){console.log(this.colors.warning("âš ï¸  Could not create state directory, using current directory")),this.stateDir=process.cwd()}}getStateFilePath(t){const s=e.basename(t)+".download-state";return e.join(this.stateDir,s)}cleanupStateFile(e){try{t.existsSync(e)&&t.unlinkSync(e)}catch(s){console.log(this.colors.warning("âš ï¸  Could not clean up state file"))}}printHeaderRow(){console.log(this.colors.success("ðŸ“ˆ %".padEnd(this.COL_PERCENT))+this.colors.yellow("ðŸ“ Files".padEnd(this.COL_FILENAME))+this.colors.cyan("ðŸ”„".padEnd(this.COL_SPINNER))+" "+this.colors.green("ðŸ“Š Progress".padEnd(this.COL_BAR+1))+this.colors.info("ðŸ“¥ Downloaded".padEnd(this.COL_DOWNLOADED))+this.colors.info("ðŸ“¦ Total".padEnd(this.COL_TOTAL))+this.colors.purple("âš¡ Speed".padEnd(this.COL_SPEED))+this.colors.pink("â±ï¸ ETA".padEnd(this.COL_ETA)))}getRandomOraSpinner(){return this.spinnerTypes[Math.floor(Math.random()*this.spinnerTypes.length)]}getRandomBarColor(){return this.barColors[Math.floor(Math.random()*this.barColors.length)]}getRandomBarGlueColor(){return this.barGlueColors[Math.floor(Math.random()*this.barGlueColors.length)]}getRandomSpinner(){return this.spinnerTypes[Math.floor(Math.random()*this.spinnerTypes.length)]}getSpinnerFrames(t){const e=n.default||n,s=e[t];return s&&s.frames?s.frames:e.dots?.frames||["â ‹","â ™","â ¹","â ¸","â ¼","â ´","â ¦","â §","â ‡","â "]}getSpinnerWidth(t){let e=0;for(const s of t){const t=s.codePointAt(0);e+=t>=126976&&t<=128767||t>=127744&&t<=128511||t>=128512&&t<=128591||t>=128640&&t<=128767||t>=128768&&t<=128895||t>=128896&&t<=129023||t>=129024&&t<=129279||t>=9728&&t<=9983||t>=9984&&t<=10175?2:1}return e}calculateBarSize(t,e=20){const s=(process.stdout.columns||120)-59-20-this.getSpinnerWidth(t);return Math.max(10,Math.min(e,s))}async checkServerSupport(t){try{const e=await fetch(t,{method:"HEAD",signal:this.abortController?.signal});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const s=e.headers.get("accept-ranges"),o=e.headers.get("content-length"),r=e.headers.get("last-modified"),u=e.headers.get("etag");return{supportsResume:"bytes"===s,totalSize:o?parseInt(o,10):0,lastModified:r,etag:u,headers:e.headers}}catch(e){return console.log(this.colors.warning("âš ï¸  Could not check server resume support, proceeding with regular download")),{supportsResume:!1,totalSize:0,lastModified:null,etag:null,headers:null}}}loadDownloadState(e){try{if(t.existsSync(e)){const s=t.readFileSync(e,"utf8");return JSON.parse(s)}}catch(s){console.log(this.colors.warning("âš ï¸  Could not load download state, starting fresh"))}return null}saveDownloadState(e,s){try{t.writeFileSync(e,JSON.stringify(s,null,2))}catch(o){console.log(this.colors.warning("âš ï¸  Could not save download state"))}}getPartialFileSize(e){try{if(t.existsSync(e)){return t.statSync(e).size}}catch(s){console.log(this.colors.warning("âš ï¸  Could not read partial file size"))}return 0}getRandomColor(){return this.colors.gradient[Math.floor(Math.random()*this.colors.gradient.length)]}formatBytes(t,e=2){if(0===t)return this.colors.info("0 B");const s=e<0?0:e,o=[{unit:"B",color:this.colors.info},{unit:"KB",color:this.colors.cyan},{unit:"MB",color:this.colors.yellow},{unit:"GB",color:this.colors.purple},{unit:"TB",color:this.colors.pink},{unit:"PB",color:this.colors.primary}],r=Math.floor(Math.log(t)/Math.log(1024)),u=parseFloat((t/Math.pow(1024,r)).toFixed(s)),i=o[r]||o[o.length-1];return i.color.bold(`${u} ${i.unit}`)}formatBytesPlain(t,e=1){if(0===t)return"0 B";const s=e<0?0:e,o=["B","KB","MB","GB","TB","PB"],r=Math.floor(Math.log(t)/Math.log(1024));return`${parseFloat((t/Math.pow(1024,r)).toFixed(s))} ${o[r]||o[o.length-1]}`}formatBytesCompact(t){if(0===t)return"0B";const e=1024,s=t/e;if(s<100){return`${Math.round(s)}KB`}return`${(t/(e*e)).toFixed(1)}`}truncateFilename(t,s=25){if(t.length<=s)return t.padEnd(s);const o=e.extname(t),r=e.basename(t,o);if(r.length<=3)return t.padEnd(s);const u=Math.ceil((s-o.length-3)/2),i=Math.floor((s-o.length-3)/2);return`${r.substring(0,u)+"..."+r.substring(r.length-i)}${o}`.padEnd(s)}formatETA(t){if(!t||t===1/0||t<0)return"   --   ";const e=Math.floor(t/3600),s=Math.floor(t%3600/60),o=Math.round(t%60);return`${e}:${s.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`.padEnd(this.COL_ETA)}formatMasterProgress(t,e){const s=1024,o=t/(s*s);if(e/(s*s)>=1024){return`${(o/1024).toFixed(1)}GB`.padEnd(this.COL_DOWNLOADED)}return`${o.toFixed(1)}MB`.padEnd(this.COL_DOWNLOADED)}formatProgress(t,e){return this.formatBytesCompact(t).padEnd(this.COL_DOWNLOADED)}formatDownloaded(t){return this.formatBytesCompact(t).padEnd(this.COL_DOWNLOADED)}formatTotalDisplay(t){if(0===t)return"0MB".padEnd(this.COL_TOTAL);const e=t/1048576;if(e>=1024){return`${(e/1024).toFixed(1)}GB`.padEnd(this.COL_TOTAL)}return e<1?`${e.toFixed(2)}MB`.padEnd(this.COL_TOTAL):`${e.toFixed(1)}MB`.padEnd(this.COL_TOTAL)}formatTotal(t){if(0===t)return"0MB".padEnd(this.COL_TOTAL);const e=t/1048576;if(e>=1024){return`${(e/1024).toFixed(1)}GB`.padEnd(this.COL_TOTAL)}return e<1?`${e.toFixed(2)}MB`.padEnd(this.COL_TOTAL):`${e.toFixed(1)}MB`.padEnd(this.COL_TOTAL)}formatSpeed(t){return t.padEnd(this.COL_SPEED)}formatSpeedDisplay(t){if(0===t)return"0B";const e=1024,s=t/e;if(s<100){return`${Math.round(s)}KB`}return`${(t/(e*e)).toFixed(1)}`}formatTotalSpeed(t){return this.formatSpeedDisplay(t).padEnd(this.COL_SPEED)}async downloadMultipleFiles(t){try{this.setupGlobalKeyboardListener();const e=this.getRandomBarColor(),s=this.getRandomBarGlueColor();this.multiBar=new gt.MultiBar({format:this.colors.success("{percentage}%")+" "+this.colors.yellow("{filename}")+" "+this.colors.cyan("{spinner}")+" "+e+"{bar}[0m "+this.colors.info("{downloadedDisplay}")+" "+this.colors.info("{totalDisplay}")+" "+this.colors.purple("{speed}")+" "+this.colors.pink("{etaFormatted}"),hideCursor:!0,clearOnComplete:!1,stopOnComplete:!0,autopadding:!1,barCompleteChar:"â–ˆ",barIncompleteChar:"â–‘",barGlue:s,barsize:this.COL_BAR});let o=0,r=0,u=new Array(t.length).fill(0),i=new Array(t.length).fill(0),a=new Array(t.length).fill(0),n=new Array(t.length).fill(Date.now()),D=Date.now(),l=new Array(t.length).fill(0),c=Date.now(),h=0;const d=t.reduce((t,e)=>t+(e.estimatedSize||104857600),0);r=d;let p=0;const m=setInterval(()=>{const e=Date.now(),s=(e-D)/1e3;for(let r=0;r<t.length;r++)if(s>0){const t=a[r]-l[r];if(u[r]=t/s,E[r]&&E[r].bar){const t=this.formatSpeed(this.formatSpeedDisplay(u[r])),e=i[r]>0?this.formatETA((i[r]-a[r])/u[r]):this.formatETA(0);E[r].bar.update(a[r],{speed:t,progress:this.formatProgress(a[r],i[r]),downloadedDisplay:this.formatBytesCompact(a[r]),totalDisplay:this.formatTotalDisplay(i[r]),etaFormatted:e})}}D=e,l=[...a];const o=u.reduce((t,e)=>t+e,0),c=a.reduce((t,e)=>t+e,0),h=(e-n[0])/1e3,d=(r>0&&o>0?this.formatETA((r-c)/o):this.formatETA(0),r>0&&Math.round(c/r*100),i.reduce((t,e)=>t+e,0)),p=d>0?d:r;F.update(c,{speed:this.formatTotalSpeed(o),progress:this.formatMasterProgress(c,p),downloadedDisplay:this.formatBytesCompact(c),totalDisplay:this.formatTotalDisplay(p),etaFormatted:this.formatETA(h),percentage:p>0?Math.round(c/p*100):0})},1e3),f=this.getSpinnerWidth("â¬‡ï¸"),g=this.COL_FILENAME-f,C=this.calculateBarSize("â¬‡ï¸",this.COL_BAR),F=this.multiBar.create(r,0,{filename:"Total".padEnd(g),spinner:"â¬‡ï¸",speed:"0B".padEnd(this.COL_SPEED),progress:this.formatMasterProgress(0,r),downloadedDisplay:this.formatBytesCompact(0),totalDisplay:this.formatTotalDisplay(r),etaFormatted:this.formatETA(0),percentage:"  0".padStart(this.COL_PERCENT-1)},{format:this.colors.success("{percentage}%")+" "+this.colors.yellow.bold("{filename}")+" "+this.colors.success("{spinner}")+" [92m{bar}[0m "+this.colors.info("{downloadedDisplay}")+" "+this.colors.info("{totalDisplay}")+" "+this.colors.purple("{speed}")+" "+this.colors.pink("{etaFormatted}"),barCompleteChar:"â–¶",barIncompleteChar:"â–·",barGlue:"[33m",barsize:C}),E=t.map((t,e)=>{const s=this.getRandomSpinner(),o=this.getSpinnerFrames(s),r=this.getSpinnerWidth(o[0]),u=this.COL_FILENAME-r,i=this.truncateFilename(t.filename,u),a=this.getRandomBarColor(),n=this.getRandomBarGlueColor(),D=this.calculateBarSize(o[0],this.COL_BAR);return{bar:this.multiBar.create(100,0,{filename:i,spinner:o[0],speed:this.formatSpeed("0B"),progress:this.formatProgress(0,0),downloadedDisplay:this.formatBytesCompact(0),totalDisplay:this.formatTotalDisplay(0),etaFormatted:this.formatETA(0),percentage:"  0".padStart(3)},{format:this.colors.yellow("{filename}")+" "+this.colors.cyan("{spinner}")+" "+a+"{bar}[0m "+this.colors.success("{percentage}%")+" "+this.colors.info("{downloadedDisplay}")+" "+this.colors.info("{totalDisplay}")+" "+this.colors.purple("{speed}")+" "+this.colors.pink("{etaFormatted}"),barCompleteChar:"â–ˆ",barIncompleteChar:"â–‘",barGlue:n,barsize:D}),spinnerFrames:o,spinnerIndex:0,lastSpinnerUpdate:Date.now(),lastFrameUpdate:Date.now(),download:{...t,index:e}}}),b=E.map(async(e,s)=>{try{return await this.downloadSingleFileWithBar(e,F,t.length,{totalDownloaded:o,totalSize:r,individualSpeeds:u,individualSizes:i,individualDownloaded:a,individualStartTimes:n,lastTotalUpdate:c,lastTotalDownloaded:h,actualTotalSize:p}),{success:!0,index:s,filename:e.download.filename}}catch(D){return{success:!1,index:s,filename:e.download.filename,error:D}}}),y=await Promise.allSettled(b);clearInterval(m),this.multiBar.stop();const B=y.filter(t=>"fulfilled"===t.status&&t.value.success).length,w=y.length-B;w>0&&(console.log(this.colors.error(`âŒ Failed: ${w}/${t.length}`)),y.forEach((e,s)=>{if("rejected"===e.status||!e.value.success){const o=t[s].filename,r=e.reason||e.value?.error||"Unknown error";console.log(this.colors.error(`  â€¢ ${o}: ${r.message||r}`))}}));const A=["ðŸ¥³","ðŸŽŠ","ðŸŽˆ","ðŸŒŸ","ðŸ’¯","ðŸš€","âœ¨","ðŸ”¥"],T=A[Math.floor(Math.random()*A.length)];console.log(this.colors.green(`${T} Success: ${B}/${t.length}`)),this.clearAbortControllers();let S=!1;this.setPauseCallback(()=>{S||(this.multiBar.stop(),console.log(this.colors.warning("â¸ï¸  Paused. Press p to resume, a to add URL.")),S=!0)}),this.setResumeCallback(()=>{S&&(console.log(this.colors.success("â–¶ï¸  Resumed. Press p to pause, a to add URL.")),S=!1)})}catch(e){throw this.multiBar&&this.multiBar.stop(),console.error(this.colors.error.bold("ðŸ’¥ Batch download failed: ")+this.colors.warning(e.message)),e}}async downloadSingleFileWithBar(e,r,u,i){const{bar:a,spinnerFrames:n,download:D}=e,{url:l,outputPath:c,filename:h}=D,d=this.getStateFilePath(c),p=c+".tmp";try{const u=new AbortController;this.setAbortController(u);const D=await this.checkServerSupport(l),h=this.loadDownloadState(d),m=this.getPartialFileSize(p);let f=0,g=!1;if(D.supportsResume&&m>0&&h){!(D.lastModified&&D.lastModified!==h.lastModified||D.etag&&D.etag!==h.etag||D.totalSize!==h.totalSize)&&m<D.totalSize?(f=m,g=!0):(t.existsSync(p)&&t.unlinkSync(p),this.cleanupStateFile(d))}else m>0&&t.existsSync(p)&&t.unlinkSync(p);const C={};g&&f>0&&(C.Range=`bytes=${f}-`);const F=await fetch(l,{headers:C,signal:u.signal});if(!F.ok)throw new Error(`HTTP error! status: ${F.status}`);const E=F.headers.get("content-length"),b=g?D.totalSize:E?parseInt(E,10):0,y={url:l,outputPath:c,totalSize:b,startByte:f,lastModified:D.lastModified,etag:D.etag,timestamp:/* @__PURE__ */(new Date).toISOString()};this.saveDownloadState(d,y),a.setTotal(b||100),a.update(f,{progress:this.formatProgress(f,b),downloadedDisplay:this.formatBytesCompact(f),totalDisplay:this.formatTotalDisplay(b)});const B=t.createWriteStream(p,{flags:g?"a":"w"});let w=f,A=Date.now(),T=w;const S=new o({read(){}}),v=F.body.getReader();(async()=>{try{for(;;){for(;this.isPaused;)await new Promise(t=>setTimeout(t,100));const{done:t,value:s}=await v.read();if(t){S.push(null);break}w+=s.length;const o=Date.now(),u=(o-A)/1e3;if(o-e.lastFrameUpdate>=150){e.spinnerIndex=(e.spinnerIndex+1)%n.length,e.lastFrameUpdate=o;const t=n[e.spinnerIndex],s=this.calculateBarSize(t,this.COL_BAR);a.options.barsize=s}if(o-e.lastSpinnerUpdate>=45e3){const t=this.getRandomSpinner();e.spinnerFrames=this.getSpinnerFrames(t),e.spinnerIndex=0,e.lastSpinnerUpdate=o}if(u>=.3){if(a.update(w,{spinner:n[e.spinnerIndex],progress:this.formatProgress(w,b),downloadedDisplay:this.formatBytesCompact(w),totalDisplay:this.formatTotalDisplay(b)}),i){const t=w-T;i.totalDownloaded+=t;const s=e.download.index||0;i.individualDownloaded[s]=w,i.individualSizes[s]=b,i.totalSize=i.individualSizes.reduce((t,e)=>t+e,0),void 0!==i.actualTotalSize&&(i.actualTotalSize=i.totalSize),b>0&&i.individualSizes[s]===b&&r.setTotal(i.totalSize)}A=o,T=w}else a.update(w,{spinner:n[e.spinnerIndex],progress:this.formatProgress(w,b),downloadedDisplay:this.formatBytesCompact(w),totalDisplay:this.formatTotalDisplay(b)});S.push(Buffer.from(s))}}catch(t){S.destroy(t)}})(),await s(S,B),t.existsSync(c)&&t.unlinkSync(c),t.renameSync(p,c),this.cleanupStateFile(d);r.value;const O=i.actualTotalSize||i.totalSize,L=i.individualSizes.reduce((t,e)=>t+e,0),x=L>0?L:O;r.update(i.totalDownloaded,{progress:this.formatMasterProgress(i.totalDownloaded,x),downloadedDisplay:this.formatBytesCompact(i.totalDownloaded),totalDisplay:this.formatTotalDisplay(x),etaFormatted:this.formatETA((Date.now()-(i.individualStartTimes?.[0]||Date.now()))/1e3)})}catch(m){throw a.update(a.total,{spinner:"âŒ",speed:this.formatSpeed("FAILED"),downloadedDisplay:this.formatBytesCompact(0),totalDisplay:this.formatTotalDisplay(0)}),console.log(this.colors.info(`ðŸ’¾ Partial download saved for ${h}. Restart to resume.`)),m}}async downloadFile(e,r){const u=this.getStateFilePath(r),i=r+".tmp";try{this.abortController=new AbortController;const a=this.getRandomOraSpinner();this.loadingSpinner=ora({text:this.colors.primary("ðŸŒ Checking server capabilities..."),spinner:a,color:"cyan"}).start();const n=await this.checkServerSupport(e),D=this.loadDownloadState(u),l=this.getPartialFileSize(i);let c=0,h=!1;if(n.supportsResume&&l>0&&D){!(n.lastModified&&n.lastModified!==D.lastModified||n.etag&&n.etag!==D.etag||n.totalSize!==D.totalSize)&&l<n.totalSize?(c=l,h=!0,this.loadingSpinner.succeed(this.colors.success(`âœ… Found partial download: ${this.formatBytes(l)} of ${this.formatTotal(n.totalSize)}`)),console.log(this.colors.info(`ðŸ”„ Resuming download from ${this.formatBytes(c)}`))):(this.loadingSpinner.warn(this.colors.warning("âš ï¸  File changed on server, starting fresh download")),t.existsSync(i)&&t.unlinkSync(i),this.cleanupStateFile(u))}else this.loadingSpinner.stop(),l>0&&(console.log(this.colors.warning("âš ï¸  Server does not support resumable downloads, starting fresh")),t.existsSync(i)&&t.unlinkSync(i));const d={};h&&c>0&&(d.Range=`bytes=${c}-`);const p=await fetch(e,{headers:d,signal:this.abortController.signal});if(!p.ok)throw new Error(`HTTP error! status: ${p.status}`);const m=p.headers.get("content-length"),f=h?n.totalSize:m?parseInt(m,10):0;m&&parseInt(m,10);h||(0===f?console.log(this.colors.warning("âš ï¸  Warning: Content-Length not provided, progress will be estimated")):console.log(this.colors.info(`ðŸ“¦ File size: ${this.formatTotal(f)}`)));const g={url:e,outputPath:r,totalSize:f,startByte:c,lastModified:n.lastModified,etag:n.etag,timestamp:/* @__PURE__ */(new Date).toISOString()};this.saveDownloadState(u,g);const C=this.getRandomBarColor(),F=this.getRandomBarGlueColor();let E=this.getRandomSpinner(),b=this.getSpinnerFrames(E),y=0;const B=this.calculateBarSize(b[0],this.COL_BAR);console.log(this.colors.success("ðŸ“ˆ %".padEnd(this.COL_PERCENT))+this.colors.cyan("ðŸ”„".padEnd(this.COL_SPINNER))+" "+this.colors.green("ðŸ“Š Progress".padEnd(this.COL_BAR+1))+this.colors.info("ðŸ“¥ Downloaded".padEnd(this.COL_DOWNLOADED))+this.colors.info("ðŸ“¦ Total".padEnd(this.COL_TOTAL))+this.colors.purple("âš¡ Speed".padEnd(this.COL_SPEED))+this.colors.pink("â±ï¸ ETA".padEnd(this.COL_ETA)));this.setupSingleFileKeyboardListeners(e,r);this.progressBar=new gt.SingleBar({format:this.colors.success("{percentage}%")+" "+this.colors.cyan("{spinner}")+" "+C+"{bar}[0m "+this.colors.info("{downloadedDisplay}")+" "+this.colors.info("{totalDisplay}")+" "+this.colors.purple("{speed}")+" "+this.colors.pink("{etaFormatted}"),barCompleteChar:"â–ˆ",barIncompleteChar:"â–‘",barGlue:F,hideCursor:!0,barsize:B,stopOnComplete:!0,clearOnComplete:!1}),this.progressBar.start(f||100,c,{speed:this.formatSpeed("0B/s"),etaFormatted:this.formatETA(0),spinner:b[0],progress:this.formatProgress(c,f),downloadedDisplay:this.formatBytesCompact(c),totalDisplay:this.formatTotalDisplay(f)});const w=t.createWriteStream(i,{flags:h?"a":"w"});let A=c,T=0,S=Date.now(),v=A,O=Date.now(),L=Date.now();const x=new o({read(){}}),R=p.body.getReader();(async()=>{try{for(;;){for(;this.isPaused;)await new Promise(t=>setTimeout(t,100));const{done:t,value:e}=await R.read();if(t){x.push(null);break}T+=e.length,A+=e.length;const s=Date.now(),o=(s-S)/1e3;if(s-O>=45e3&&(E=this.getRandomSpinner(),b=this.getSpinnerFrames(E),y=0,O=s),s-L>=120){y=(y+1)%b.length,L=s;const t=b[y],e=this.calculateBarSize(t,this.COL_BAR);this.progressBar.options.barsize=e}if(o>=.3){const t=(A-v)/o,e=this.formatSpeed(this.formatSpeedDisplay(t)),r=f>0?this.formatETA((f-A)/t):this.formatETA(0);this.progressBar.update(A,{speed:e,etaFormatted:r,spinner:b[y],progress:this.formatProgress(A,f),downloadedDisplay:this.formatBytesCompact(A),totalDisplay:this.formatTotalDisplay(f)}),S=s,v=A}else this.progressBar.update(A,{spinner:b[y],progress:this.formatProgress(A,f),downloadedDisplay:this.formatBytesCompact(A),totalDisplay:this.formatTotalDisplay(f)});x.push(Buffer.from(e))}}catch(t){x.destroy(t)}})(),await s(x,w),this.progressBar.stop(),t.existsSync(r)&&t.unlinkSync(r),t.renameSync(i,r),this.cleanupStateFile(u),console.log(this.colors.success("âœ… Download completed!")),console.log(this.colors.primary("ðŸ“ File saved to: ")+Ut.underline(r)),console.log(this.colors.purple("ðŸ“Š Total size: ")+this.formatBytes(A)),h&&(console.log(this.colors.info("ðŸ”„ Resumed from: ")+this.formatBytes(c)),console.log(this.colors.info("ðŸ“¥ Downloaded this session: ")+this.formatBytes(T)));const P=["ðŸ¥³","ðŸŽŠ","ðŸŽˆ","ðŸŒŸ","ðŸ’¯","ðŸš€","âœ¨","ðŸ”¥"],M=P[Math.floor(Math.random()*P.length)];console.log(this.colors.success(`${M} Successfully downloaded! ${M}`))}catch(a){throw this.loadingSpinner&&this.loadingSpinner.isSpinning&&this.loadingSpinner.fail(this.colors.error("âŒ Connection failed")),this.progressBar&&this.progressBar.stop(),console.error(this.colors.error.bold("ðŸ’¥ Download failed: ")+this.colors.warning(a.message)),"AbortError"===a.name?console.log(this.colors.info("ðŸ’¾ Download state saved. You can resume later by running the same command.")):console.log(this.colors.info("ðŸ’¾ Partial download saved. Restart to resume from where it left off.")),a}}cleanup(){if(this.loadingSpinner&&this.loadingSpinner.isSpinning&&this.loadingSpinner.stop(),this.progressBar&&this.progressBar.stop(),this.multiBar&&this.multiBar.stop(),this.abortController&&this.abortController.abort(),this.keyboardListener)try{this.keyboardListener.kill()}catch(t){}process.stdin.isTTY&&(process.stdin.setRawMode(!1),process.stdin.pause())}setupGlobalKeyboardListener(){this.setupFallbackKeyboardListener()}async handleGlobalKeyPress(t){"P"===t?(console.log(this.colors.info("P key pressed - toggling pause/resume")),this.isPaused?this.resumeAll():this.pauseAll()):"A"!==t||this.isAddingUrl||(console.log(this.colors.info("A key pressed - adding URL")),await this.promptForNewUrl())}async promptForNewUrl(){this.isAddingUrl=!0;try{console.log(this.colors.cyan("\nðŸ“¥ Enter URL to add (or press Enter to cancel):"));const o=r.createInterface({input:process.stdin,output:process.stdout}),u=await new Promise(t=>{o.question("",e=>{o.close(),t(e.trim())})});if(u&&this.isValidUrl(u)){console.log(this.colors.success(`âœ… Adding URL: ${u}`));const o=this.generateFilename(u),r=e.isAbsolute(o)?o:e.join(process.cwd(),o),i=e.dirname(r);try{t.existsSync(i)||t.mkdirSync(i,{recursive:!0})}catch(s){return void console.error(this.colors.red.bold("âŒ Could not create output directory: ")+s.message)}this.multiBar?await this.addToMultipleDownloads(u,r,o):this.downloadFile(u,r).catch(t=>{console.error(this.colors.error(`âŒ Failed to download ${o}: ${t.message}`))}),console.log(this.colors.success("ðŸš€ New download started!"))}else u?console.log(this.colors.red("âŒ Invalid URL provided.")):console.log(this.colors.yellow("âš ï¸  No URL provided, cancelling."))}catch(s){console.error(this.colors.red("âŒ Error adding URL: ")+s.message)}finally{this.isAddingUrl=!1,this.isPaused?console.log(this.colors.warning("â¸ï¸  Still paused. Press p to resume, a to add URL.")):console.log(this.colors.success("â–¶ï¸  Downloads active. Press p to pause, a to add URL."))}}async addToMultipleDownloads(t,e,s){const o=this.getRandomSpinner(),r=this.getSpinnerFrames(o),u=this.getSpinnerWidth(r[0]),i=this.COL_FILENAME-u,a=this.truncateFilename(s,i),n=this.getRandomBarColor(),D=this.getRandomBarGlueColor(),l=this.calculateBarSize(r[0],this.COL_BAR),c={url:t,outputPath:e,filename:s},h={bar:this.multiBar.create(100,0,{filename:a,spinner:r[0],speed:this.formatSpeed("0B"),progress:this.formatProgress(0,0),downloadedDisplay:this.formatBytesCompact(0),totalDisplay:this.formatTotalDisplay(0),etaFormatted:this.formatETA(0),percentage:"  0".padStart(3)},{format:this.colors.yellow("{filename}")+" "+this.colors.cyan("{spinner}")+" "+n+"{bar}[0m "+this.colors.success("{percentage}%")+" "+this.colors.info("{downloadedDisplay}")+" "+this.colors.info("{totalDisplay}")+" "+this.colors.purple("{speed}")+" "+this.colors.pink("{etaFormatted}"),barCompleteChar:"â–ˆ",barIncompleteChar:"â–‘",barGlue:D,barsize:l}),spinnerFrames:r,spinnerIndex:0,lastSpinnerUpdate:Date.now(),lastFrameUpdate:Date.now(),download:{...c,index:this.getCurrentDownloadCount()}};this.downloadSingleFileWithBar(h,this.getMasterBar(),this.getCurrentDownloadCount()+1,{totalDownloaded:0,totalSize:0,individualSpeeds:[],individualSizes:[],individualDownloaded:[],individualStartTimes:[],lastTotalUpdate:Date.now(),lastTotalDownloaded:0,actualTotalSize:0}).catch(t=>{console.error(this.colors.error(`âŒ Failed to download ${c.filename}: ${t.message}`))})}getCurrentDownloadCount(){return 1}getMasterBar(){return null}setupFallbackKeyboardListener(){if(process.stdin.isTTY){process.stdin.setRawMode(!0),process.stdin.resume(),process.stdin.setEncoding("utf8");const t=async t=>{""===t&&(console.log(this.colors.yellow.bold("\nðŸ›‘ Download cancelled by user")),process.exit(0)),"p"===t.toLowerCase()&&(console.log(this.colors.info("P key pressed - toggling pause/resume")),this.isPaused?this.resumeAll():this.pauseAll()),"a"!==t.toLowerCase()||this.isAddingUrl||(console.log(this.colors.info("A key pressed - adding URL")),await this.promptForNewUrl())};process.stdin.on("data",t)}}setupSingleFileKeyboardListeners(t,e){return this.setupGlobalKeyboardListener(),null}isValidUrl(t){try{return new URL(t),!0}catch{return!1}}getFileExtension(t){try{const s=new URL(t).pathname;return e.extname(s).toLowerCase()}catch{return""}}generateFilename(t){try{return e.basename(new URL(t).pathname)||"downloaded-file"}catch(s){return"downloaded-file"}}setPauseCallback(t){this.pauseCallback=t}setResumeCallback(t){this.resumeCallback=t}setAbortController(t){this.abortControllers.push(t)}clearAbortControllers(){this.abortControllers=[]}pauseAll(){this.isPaused=!0,console.log(this.colors.warning("â¸ï¸  Pausing all downloads...")),this.pauseCallback&&this.pauseCallback()}resumeAll(){this.isPaused=!1,console.log(this.colors.success("â–¶ï¸  Resuming all downloads...")),this.resumeCallback&&this.resumeCallback()}}if("boolean"==typeof import.meta.main&&import.meta.main||(()=>{try{const t=process.argv[1]?e.resolve(process.argv[1]):"";if(!t)return!1;const s=i(t).href;return import.meta.url===s}catch{return!1}})()){const s=(new Gt).usage("Usage: grab-url <url...> [options]").command("$0 <url>","Fetch data or download files; pass one or more URLs").option("no-save",{type:"boolean",default:!1,describe:"Don't save output to file, just print to console"}).option("output",{alias:"o",type:"string",describe:"Output filename (default: output.json)",default:null}).option("params",{alias:"p",type:"string",describe:'JSON string of query parameters (e.g., \'{"key":"value"}\')',coerce:t=>{if(!t)return{};try{return JSON.parse(t)}catch(e){throw new Error(`Invalid JSON in params: ${t}`)}}}).help().alias("h","help").example("grab-url https://api.example.com/data","Fetch JSON/text from an API and save to output.json").example("grab-url https://example.com/file1.zip https://example.com/file2.zip","Download multiple files concurrently").example("grab-url https://example.com/file.iso -o ubuntu.iso","Save the first URL to a custom filename").version("1.0.0").strict().parseSync(),o=s.urls||[],r=s.params||{},u=s.output,i=s["no-save"],a=o.some(function(t){return/\.[a-zA-Z0-9]{1,5}(?:\.[a-zA-Z0-9]{1,5})*$/.test(t.split("?")[0])}),n=o.length>1||a;(async()=>{if(n){const r=new Wt,i=o.map((t,e)=>{let s=null;return 0===e&&u&&(s=u),{url:t,outputPath:s}}).map((s,o)=>{let u=s.url,i=s.outputPath;i||(i=r.generateFilename(u));const a=e.isAbsolute(i)?i:e.join(process.cwd(),i),n=e.dirname(a);try{t.existsSync(n)||t.mkdirSync(n,{recursive:!0})}catch(D){console.error(Ut.red.bold("âŒ Could not create output directory: ")+D.message),process.exit(1)}return{url:u,outputPath:a,filename:e.basename(i)}});try{await r.downloadMultipleFiles(i);const e=new Table({head:["Filename","Size","Created"],colWidths:[32,14,25],colAligns:["left","right","left"],style:{"padding-left":1,"padding-right":1,head:[],border:[]}});i.forEach(s=>{try{const o=t.statSync(s.outputPath);e.push([s.filename,r.formatBytes(o.size),o.birthtime.toLocaleString()])}catch(o){e.push([s.filename,"Error","Could not read"])}}),console.log(Ut.cyan.bold("\nFile Details:")),console.log(e.toString())}catch(s){console.error(Ut.red.bold("Failed to download files: ")+Ut.yellow(s.message)),process.exit(1)}r.cleanup()}else{const a=o[0],n=process.hrtime();try{const s=await m(a,r);s.error&&D(`\n\nStatus: âŒ ${s.error}`);let o,l=null,c=!1;if("string"==typeof s.data)o=s.data,c=!0;else if(Buffer.isBuffer(s.data)||s.data instanceof Uint8Array)o=s.data,c=!1;else if(s.data instanceof Blob){const t=await s.data.arrayBuffer();o=Buffer.from(t),c=!1}else s.data&&"object"==typeof s.data?(o=JSON.stringify(s.data,null,2),c=!0):(o=String(s.data),c=!0);if(i)D(c?o:`Binary data received (${o.length} bytes). Use --output to save to file.`);else{const s=new URL(a).pathname,r=e.extname(s),i=c?".json":r||".bin";l=u?e.resolve(u):e.resolve(process.cwd(),`output${i}`),c?t.writeFileSync(l,o,"utf8"):t.writeFileSync(l,o);const[h,d]=process.hrtime(n),p=(h+d/1e9).toFixed(2),m=t.statSync(l);D(`â±ï¸ ${p}s ðŸ“¦ ${(m.size/1048576).toFixed(1)}MB âœ… Saved to: ${l}`)}}catch(s){D(`Error: ${s.message}`,{color:"red"}),process.exit(1)}}})()}export{Wt as ColorFileDownloader};
//# sourceMappingURL=download.es.js.map
